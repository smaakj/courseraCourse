LPVault={};
var initialize=function(d,b,na){var oa=Strings.translateString("Folder (a-z)"),pa=Strings.translateString("Folder (z-a)"),A=Strings.translateString("Name (a-z)"),B=Strings.translateString("Name (z-a)"),P=Strings.translateString("Most Recent"),qa=Strings.translateString("Sender (a-z)"),ra=Strings.translateString("Sender (z-a)"),sa=Strings.translateString("Recipient (a-z)"),ta=Strings.translateString("Recipient (z-a)"),D=[oa,pa,A,B,P],Qa=[A,B],Ra=[A,B,sa,ta,P],Sa=[A,B,qa,ra,P],Ta=[A,B],Ua=[A,B],r=function(a){this.options=
a};r.prototype.getAddElement=function(){void 0===this.addElement&&(this.addElement=LPTools.createElement("div","addMenuItem"),this.build(this.addElement,this.options.icon?this.options.icon:"images/vault_4.0/Add.png"));return this.addElement};r.prototype.build=function(a,c){var b=this.options.autoId||"";a.appendChild(LPTools.createElement("span",null,Strings.Vault[this.options.text])).setAttribute("automation-id",b);b=LPTools.createElement("div");var k=LPTools.createElement("div");c=LPTools.createElement("img",
{src:c});a.appendChild(b);b.appendChild(k);k.appendChild(c);$(a).bind("click",this.options.func)};r.prototype.getMenuElement=function(){void 0===this.menuElement&&(this.menuElement=LPTools.createElement("li","addMenuItem"),this.build(this.menuElement,this.options.additionalIcon));return this.menuElement};var Va=new r({text:"ADD_SITE",autoId:"vaultAddSiteButton",icon:"images/vault_4.0/Sites_Active.png",func:function(){b.openSiteDialog({saveOptions:{source:"vault"}})}}),Z=new r({text:"ADD_NOTE",autoId:"vaultAddNoteButton",
icon:"images/vault_4.0/Notes_Active.png",additionalIcon:"images/vault_4.0/Add_Secure_Note.png",func:function(){b.openNoteDialog({saveOptions:{source:"vault"}})}}),Wa=new r({text:"ADD_FORM_FILL",autoId:"vaultAddFormFillButton",icon:"images/vault_4.0/Form_Fills_Active.png",func:function(){b.openFormFillDialog({saveOptions:{source:"vault"}})}}),Xa=new r({text:"ADD_SHARED_FOLDER",autoId:"vaultAddSharedFolderButton",func:function(){b.openCreateSharedFolderDialog()}}),Ya=new r({text:"ADD_IDENTITY",autoId:"vaultAddIdentityButton",
func:function(){b.openIdentityDialog()}}),Za=new r({text:"GIVE_EMER_ACCESS",autoId:"vaultGiveEmerAccessButton",func:function(){LPProxy.getUser().isFreeOrTrial()&&LPFeatures.restrictEmergencyAccessForFree()||LPProxy.isExpiredFamilyUser()?(bg.sendLpImprove("restricted_emergency_access_lightbox_shown"),dialogs.restrictedEmergencyAccess.open()):dialogs.addEmergencyAccess.open()}}),$a=new r({text:"ADD_CREDIT_MON",autoId:"vaultAddCreditButton",func:function(){b.openCreateCreditMonitoringDialog()}}),aa=
new r({text:"ADD_FOLDER",autoId:"vaultAddNewFolderButton",additionalIcon:"images/vault_4.0/Add_Folder.png",func:function(){b.openFolderDialog()}}),H=new r({text:"SHARE_ITEMS",autoId:"vaultAddShareItemsButton",additionalIcon:"images/vault_4.0/Add_Share.png",func:function(){b.openShareDialog()}}),ab=Strings.translateString("search my vault"),u=null,ba=$("#advacedOptionsOverlay"),bb=$("#inProgressOverlay"),Q=$("#tools"),cb=$("#options"),t=$("#mainScroll"),x=$("#addMenu"),ua=$("#addMenuItems"),va=$("#addMenuButton"),
wa=$("#addMenuButtonCustom"),xa=$("#gridButton"),ya=$("#listButton"),R=$("#collapseAllToggle"),S=$("#sizeToggle"),za=$("#orderOption"),Aa=$("#sortOrderMenu"),db=$("#sortOrderOption"),ca=$("#userMenuItems"),E=$("#leftMenuMinimizeButton"),Ba=$("#moreActions"),Ca=d.getElementById("contextMenu").parentElement,l=$(d.body),da=$("#advancedMenuItem"),ea=d.getElementById("sortOrderMenu").children[0],v=$("#vaultSearch"),Da=$("#userMenuContainer"),eb=$("#pageTitle"),Ea=$("#cloudAppsMenuItem"),T=null,F=null,
U=!0,m=null,w=null,h=null,Fa=function(a,c){h.getContainer()===c&&(h.removeBodyState(),h.addBodyState())},e=function(a){a=a||{};this.state=a.bodyState;this.menuElement=a.menuElement||null;this.emptyState=this.state+"Empty";this.container=null;this.sortOptions=a.sortOptions||null;this.persistent=LPTools.getOption(a,"persistent",!0);this.searchPlaceholder=LPTools.getOption(a,"searchPlaceholder",ab);this.title=a.title||"";this.addMenu=a.addMenu;this.additionalOptionButtons=a.additionalOptionButtons;this.scrollParent=
a.scrollParent;this.notificationCount=a.notificationCount;(function(c){Topics.get(Topics.CLEAR_DATA).subscribe(function(){c.clear()});a.menuElement&&a.menuElement.unbind("click.menu").bind("click.menu",function(){var a=void 0;try{var b=LPProxy.getConfigViewObject(c.getElement().id);void 0!==b.segmentEvent&&bg.sendLpImprove(b.segmentEvent);a=b.url}catch(f){}void 0!==a?bg.openOnNewTab(a):c.parent?c.parent.show(c):c.show()})})(this)};(function(){e.prototype.getElement=function(){return this.menuElement.get(0)};
e.prototype.applyContainerFunction=function(a){var c=this.getContainer();if(null!==c)switch(typeof a){case "string":var b=[];if(1<arguments.length)for(var k=1,f=arguments.length;k<f;++k)b.push(arguments[k]);return c[a].apply(c,b);case "function":return a(c)}};e.prototype.updateNotificationCount=function(a){var c=0,b=this.menuElement.find(".tabNotification");"undefined"!==typeof a?(c=parseInt(b.text()),V(b,c-a),this.parent&&this.parent.updateNotificationCount(a)):this.notificationCount&&(c=this.notificationCount(),
V(b,c));return c};e.prototype.getSortOptions=function(){return this.sortOptions};e.prototype.getContainer=function(){return this.container};e.prototype.setContainer=function(a,c){if(this.container=a)a._buildOptions.stateChangeCallback=Fa,LPTools.getOption(c,"checkForStateChange",!0)&&h===this&&Fa(a.isEmpty(),a),h===this&&""!==v.val()&&b.search(v.val())};e.prototype.openAll=function(){this.applyContainerFunction("openAll")};e.prototype.collapseAll=function(){this.applyContainerFunction("collapseAll")};
e.prototype.createSelectionContextMenu=function(){return this.applyContainerFunction("createSelectionContextMenu")};e.prototype.isEmpty=function(){return this.applyContainerFunction("isEmpty")};e.prototype.search=function(a){var c=this.applyContainerFunction("applySearch",a);a&&null===c&&!this.isEmpty()?l.addClass("searchEmpty"):l.removeClass("searchEmpty")};e.prototype.clearSelected=function(){this.applyContainerFunction("clearSelected")};e.prototype.getSelectedItems=function(){return this.applyContainerFunction("getSelectedItems")};
e.prototype.getSortOrder=function(){void 0===this.sortOrder&&(this.sortOrder=LPProxy.getPreference(this.state+"SortOrder",this.sortOptions?this.sortOptions[0]:null));return this.sortOrder};e.prototype.setSortOrder=function(a){this.sortOrder=a;LPProxy.setPreferences(this.state+"SortOrder",a)};e.prototype.addBodyState=function(){l.addClass(this.getState());var a=this.getContainer();null!==a&&a.isEmpty()?l.addClass("empty"):l.removeClass("empty");setTimeout(function(){Topics.get(Topics.EMPTY_VAULT_STATE_CHANGE).publish()},
400)};e.prototype.removeBodyState=function(){l.removeClass(this.emptyState);l.removeClass(this.state)};e.prototype.hide=function(){null!==this.menuElement&&this.menuElement.removeClass("selected");this.parent&&null!==this.parent.menuElement&&this.parent.menuElement.removeClass("selected");this.removeBodyState();if(this.additionalOptionButtons)for(var a=0,c=this.additionalOptionButtons.length;a<c;++a)this.additionalOptionButtons[a].detach();this.persistent?this.applyContainerFunction("hide"):this.clear()};
e.prototype.getAddMenuItems=function(){var a=[];if(this.addMenu&&0<this.addMenu.length)for(var c=0,b=this.addMenu.length;c<b;++c){var k=this.addMenu[c];k===H&&!LPFeatures.allowIndividualSharing()||k===Z&&!LPFeatures.allowNotes()||a.push(k)}return a};e.prototype.show=function(){if(h!==this){null!==h&&(v.val(""),C(),h.hide());v.attr("placeholder",this.searchPlaceholder);null!==this.menuElement&&this.menuElement.addClass("selected");this.parent&&null!==this.parent.menuElement&&this.parent.menuElement.addClass("selected");
eb.text(this.title);this.addBodyState();this.scrollParent.scrollTop(0);var a=this.getSortOptions();if(null===h||h.getSortOptions()!==a)if(null!==a){LPTools.removeDOMChildren(ea);for(var c=0,g=a.length;c<g;++c){var k=d.createElement("li"),f=a[c];k.textContent=f;LPPlatform.addEventListener(k,"click",fb(f));ea.appendChild(k)}za.show()}else za.hide();h=this;(a=this.getSortOrder())&&b.sort(a);this.additionalOptionButtons&&cb.append(this.additionalOptionButtons);ua.children().detach();wa.children().detach();
a=this.getAddMenuItems();if(0<a.length){wa.append(a[0].getAddElement());for(c=a.length-1;0<c;--c)ua.append(a[c].getMenuElement());va.show()}else va.hide();LPProxy.getPreference("leftMenuMaximize")?b.maximizeLeftMenu():b.minimizeLeftMenu()}};e.prototype.getState=function(){return this.isEmpty()?this.emptyState:this.state};e.prototype.clear=function(){this.container&&(this.container.destruct(),this.container=null)}})();var p=function(a){a.bodyState=a.bodyState||a.contentID;e.call(this,a);this.contentElement=
d.getElementById(a.contentID);this.containerType=a.containerType;this.dataSource=a.dataFunction;this.buildOptions=a.buildOptions;this.filter=a.filter;(function(a){Topics.get(Topics.IDENTITY_ENABLE).subscribe(function(c){a.refresh(c)});a.initializeCallback=function(c,b){c=new a.containerType(c,a.buildOptions);c.initialize(a.contentElement,a.scrollParent);a.filter&&c.applyFilter(a.filter,{checkForStateChange:!1});a.setContainer(c,{checkForStateChange:LPTools.getOption(b,"checkForStateChange",!1)});
Topics.get(Topics.DIALOG_LOADED).publish()}})(this)};p.prototype=Object.create(e.prototype);p.prototype.constructor=p;(function(){p.prototype.makeDataRequest=function(a,c){c.error=function(){Topics.get(Topics.DIALOG_LOADED).publish()};LPRequest.makeDataRequest(a,c)};p.prototype.initialize=function(a,c){null===this.container&&null!==this.containerType&&null!==this.dataSource&&(a=function(a,c){return c?function(b,g){a.initializeCallback(b,g);c()}:a.initializeCallback}(this,a),Topics.get(Topics.DIALOG_LOADING).publish(),
this.dataSource.call(this,a,c))};p.prototype.show=function(a){null===this.container?function(c){c.initialize(function(){a&&a();e.prototype.show.apply(c)})}(this):(e.prototype.show.apply(this),a&&a())};p.prototype.refresh=function(a){null!==this.container&&(this.container.destruct(),this.container=null,this.initialize(null,{identity:a,checkForStateChange:!0}))}})();var y=function(a){e.call(this,a);this.setContainer(a.container||null);this.filter=a.filter};y.prototype=Object.create(e.prototype);y.prototype.constructor=
y;y.prototype.show=function(){this.container.applyFilter(this.filter,{checkForStateChange:!1});e.prototype.show.apply(this,arguments)};var Ga=function(a){var c=null;if(a.views&&0<a.views.length){for(var b=0,k=a.views.length;b<k;++b)a.views[b].parent=this;this.show=function(b,g){b?(b.show(g),c=b):(null===c&&(c=a.defaultView()),c.show(g))};this.clear=function(){c=null};this.menuElement=a.menuElement;var f=a.menuElement.find(".notificationBubble");this.updateNotificationCount=function(a){for(var c=0,
b=f.length;c<b;++c){var g=$(f[c]);V(g,parseInt(g.text())-a)}};b=function(){for(var c=0,b=0,g=a.views.length;b<g;++b)c+=a.views[b].updateNotificationCount();V(f,c)};Topics.get(Topics.LOGIN).subscribe(b);Topics.get(Topics.REFRESH_DATA).subscribe(b);(function(a){Topics.get(Topics.CLEAR_DATA).subscribe(function(){a.clear()})})(this)}},Ha=new p({containerType:IdentityContainer,dataFunction:function(a){for(var c=[],b=0,k=u._identities.length;b<k;++b)c.push(u._identities[b].newDisplayObject());a(c)},sortOptions:Ua,
contentID:"identityContent",bodyState:"identity",scrollParent:t,searchPlaceholder:Strings.translateString("search my identities"),buildOptions:{multiSelect:!1},title:Strings.translateString("Identities"),addMenu:[Ya]}),W=new p({containerType:CreditMonitoringContainer,dataFunction:function(){return function(a,c){this.makeDataRequest(LPProxy.getCreditMonitoringData,{success:function(b){for(var g=!0,f=[],d=0,e=b.length;d<e;++d){var n=b[d];"1"!==n.premium&&(g=!1);f.push(new CreditMonitoringProfile(n))}b=
$("#creditMonitoring .viewExplanation");g?(b.hide(),W.title=Strings.translateString("Premium Credit Monitoring")):(b.show(),W.title=Strings.translateString("Credit Monitoring"));a(f,c)}})}}(),persistent:!1,contentID:"creditMonitoring",scrollParent:t,title:Strings.translateString("Credit Monitoring"),addMenu:[$a]}),fa=new p({containerType:GridListContainer,dataFunction:function(a,c){this.makeDataRequest(LPProxy.getDeletedItems,{success:a})},filter:{showEmptyGroups:!1},sortOptions:D,contentID:"deletedItems",
scrollParent:t,persistent:!1,searchPlaceholder:Strings.translateString("search my deleted items"),buildOptions:{allowDrag:!1,stickyFolders:!0,stickyFolderParent:d.getElementById("main")},title:Strings.translateString("Deleted Items"),additionalOptionButtons:[function(){var a=LPTools.createElement("div",{"class":"optionButton optionButtons",id:"purgeAllButton"},Strings.Vault.PURGE_ALL);LPPlatform.addEventListener(a,"click",function(){var a=fa.getContainer();a&&(a=a.getItemModelChildren(),0<a.length&&
a[0].purge({itemsForAction:a}))});return $(a)}()]});fa.refresh=function(){};var I=new p({containerType:EmergencyAccessRecipientContainer,dataFunction:function(a,c){this.makeDataRequest(LPProxy.getEmergencyAccessRecipientInfo,{success:a})},filter:{showEmptyGroups:!1},sortOptions:D,menuElement:$("#emergencyTrustedMenuItem"),contentID:"emergencyTrustedContainer",bodyState:"emergencyTrusted",scrollParent:t,persistent:!1,searchPlaceholder:Strings.translateString("search people I trust"),buildOptions:{allowDrag:!1},
title:Strings.translateString("People I Trust"),addMenu:[Za]}),J=new p({containerType:EmergencyAccessSharerContainer,dataFunction:function(a,c){this.makeDataRequest(LPProxy.getEmergencyAccessSharerInfo,{success:a})},filter:{showEmptyGroups:!1},notificationCount:function(){var a=0,c=bg.get("g_emer_sharers");if(c)for(var b=0,k=c.length;b<k;++b)"0"===c[b].accepted&&++a;return a},sortOptions:D,menuElement:$("#emergencyTrustingMenuItem"),contentID:"emergencyTrusting",bodyState:"emergencyTrusting",scrollParent:t,
persistent:!1,searchPlaceholder:Strings.translateString("search people who trust me"),buildOptions:{allowDrag:!1},title:Strings.translateString("People Who Trust Me")}),ha=new Ga({menuElement:$("#emergencyAccessMenuItem"),defaultView:function(){return 0<J.notificationCount()?J:I},views:[I,J]}),K=new p({containerType:IndividualShareContainer,sortOptions:Sa,menuElement:$("#receivedSharesMenuItem"),contentID:"receivedSharesContent",bodyState:"receivedShares",scrollParent:t,persistent:!1,notificationCount:function(){return bg.get("g_pendings").length},
searchPlaceholder:Strings.translateString("search my received shares"),buildOptions:{multiSelect:!1},filter:{showEmptyGroups:!1,multiSelect:!1},title:Strings.translateString("Shared with Me"),addMenu:[H],dataFunction:function(){return function(a,c){this.makeDataRequest(LPProxy.getReceivedShareData,{params:{url:document.location.href},success:function(c){for(var b=LPProxy.getAllModelItems(),g=[],d=0,e=b.length;d<e;++d){var n=b[d],h=c[n.getID()];h&&"1"===h.state&&n instanceof AccountBase&&g.push(new AcceptedReceivedSharedItem(n,
h))}b=LPProxy.getPendingRecievedShares();d=!1;e=0;for(n=b.length;e<n;++e){h=b[e];var l=c[h._model.getID()];l?h._model._shareData=l:d=!0}d&&LPProxy.refreshSites();a(g.concat(b))}})}}()}),L=new p({containerType:IndividualShareContainer,sortOptions:Ra,menuElement:$("#sentSharesMenuItem"),contentID:"sentSharesContent",bodyState:"sentShares",scrollParent:t,persistent:!1,searchPlaceholder:Strings.translateString("search my sent shares"),buildOptions:{multiSelect:!1},filter:{showEmptyGroups:!1,multiSelect:!1},
title:Strings.translateString("Shared with Others"),addMenu:[H],dataFunction:function(){return function(a,c){this.makeDataRequest(LPProxy.getSentShareData,{params:{},success:function(b){for(var g=LPProxy.getAllModelItems(),f=[],d=0,e=g.length;d<e;++d){var n=g[d];f=f.concat(LPTools.buildSentShareItems(n,b[n.getID()]))}a(f,c)}})}}()}),z=new p({containerType:SharedFolderContainer,dataFunction:function(){return function(a,c){this.makeDataRequest(LPProxy.getSharedFolderData,{params:{},success:function(c){for(var b=
LPProxy.getAllSharedGroupModelsByID(),g=[],d=0,e=c.length;d<e;++d){var n=c[d];n.sharedata&&g.push(new SharedFolderItem(b[n.shareid],n))}a(g)}})}}(),notificationCount:function(){return bg.get("g_pending_shares").length},sortOptions:Ta,menuElement:$("#sharedFoldersMenuItem"),contentID:"sharedFoldersContent",bodyState:"sharedFolders",scrollParent:t,searchPlaceholder:Strings.translateString("search my shared folders"),buildOptions:{multiSelect:!1},title:Strings.translateString("Shared Folders"),addMenu:[Xa],
additionalOptionButtons:[function(){var a=$(LPTools.buildCheckbox(null,{text:Strings.translateString("View Deleted Shared Folders")}));a.attr("id","showDeletedSharedFoldersButton");a.addClass("optionButtons");a.bind("click",function(){M?ia():ja()});return a}()]});z.initialize=function(a,c){a=function(a,c){return c?function(){var a={checkForStateChange:!1};M?ja(a):ia(a);c()}:function(){var a={checkForStateChange:!1};M?ja(a):ia(a)}}(this,a);p.prototype.initialize.call(this,a,c)};var N=new Ga({menuElement:$(".sharingMenuItem"),
defaultView:function(){return 0<K.notificationCount()?K:LPProxy.getAccountClass()===Constants.USER_FREE||LPProxy.getAccountClass()===Constants.USER_PREMIUM&&LPProxy.isPremiumAsAPerk()&&!LPProxy.isLegacyPremium()?L:LPFeatures.allowSharedFolders()?z:K},views:[z,L,K]});new e({menuElement:$("#newSettingsMenuItem"),bodyState:"newSettings",title:Strings.translateString("Settings"),addMenu:null,scrollParent:$(document.body)});var O=function(){LPTools.hideContextMenu(w);w=null},G=function(a){a.preventDefault();
a.stopPropagation()},la=function(){O();ca.hide("fast");Da.removeClass("selected");ka();Ia()},C=function(){h&&h.clearSelected()},fb=function(a){return function(c){O();b.sort(a);G(c)}},ka=function(){da.removeClass("selected");Q.hide("fast");ba.hide()},Ja=function(){x.addClass("open")},Ia=function(){x.removeClass("open")};b.initializeWelcomeDialogs=function(){bg.get_method_async(function(a){bg.MigrationBackground.getShouldStartMigration(function(c){c?(bg.MigrationBackground.setShouldStartMigration(!1),
Ka()):bg.MigrationBackground.shouldShowMigrationNotification()&&bg.MigrationBackground.hasFormFills()?dialogs.vaultInfoBanner.open({title:Strings.translateString("A new version of LastPass is here!"),contentText1:Strings.translateString("You can now do even more with LastPass - Update now to see what's changed (it only takes a minute)."),segmentEvents:{show:{name:"migration_formfill_notification_shown",properties:{version:"vault"}},update:{name:"migration_formfill_notification_clicked",properties:{action:"update_now",
version:"vault"}}},buttons:[{style:"btn-blue",sizeStyle:"col-2 btn-container-lg",autoId:"updateNowBtn",text:Strings.translateString("Update Now"),closeOnClick:!0,action:function(){bg.MigrationBackground.setShouldStartMigration(!1);Ka()},segment:"update"}],hideXCloseBtn:!0}):LPFeatures.safari_legacy_messaging()?dialogs.vaultInfoBanner.open({title:Strings.translateString("Safari extension update required"),contentText1:Strings.translateString("Due to new Apple requirements, you need to download the new LastPass app to continue using LastPass in your Safari browser."),
contentText2:Strings.translateString("After download, simply login to your account again and use LastPass in Safari as you always have."),buttons:[{style:"btn-blue",sizeStyle:"col-2 btn-container-lg",autoId:"updateBtn",text:Strings.translateString("Update"),closeOnClick:!0,action:function(){bg&&bg.openURL&&bg.openURL("https://lastpass.com/safariAppExtension.php?source=vault")}},{style:"btn-link",sizeStyle:"col-1 btn-container-sm",autoId:"closeBtn",text:Strings.translateString("Close"),closeOnClick:!0}]}):
"undefined"===typeof a&&null===top.ext&&LPFeatures.allowLicenseExpiration()&&(VaultLicenseExpiration.premiumTrialStatusChecker()||VaultLicenseExpiration.companyLicenseStatusChecker())?VaultLicenseExpiration.showExpirationMessage():"1"==bg.get("g_show_original_language_changed_notification")&&("undefined"===typeof a&&null===top.ext||bg.get("g_is_ie"))?LanguageDowngradeNotification.show():"undefined"===typeof a&&null===top.ext&&LPFeatures.isDownloadExtensionWebPromptEnabled()?dialogs.vaultInfoBanner.open({title:Strings.translateString("Download the LastPass browser extension"),
segmentEvents:{show:{name:"download_extension_prompt_shown"},download:{name:"download_extension_prompt_clicked",properties:{action:"download"}},noThanks:{name:"download_extension_prompt_clicked",properties:{action:"no_thanks"}},close:{name:"download_extension_prompt_clicked",properties:{action:"close"}}},contentText1:Strings.translateString("Get the most out of LastPass so you can automatically save and fill your passwords, credit cards, addresses, and more."),contentText2:Strings.translateString("Install the LastPass browser extension for simple, quick access right from the LastPass icon in your browser toolbar."),
buttons:[{style:"btn-blue",sizeStyle:"col-2 btn-container-lg",autoId:"downloadNowBtn",text:Strings.translateString("Download Now"),action:function(){"object"===typeof top.LP_ExtInstall&&"function"===typeof top.LP_ExtInstall.run?top.LP_ExtInstall.run():bg&&bg.openURL&&bg.openURL("https://lastpass.com/misc_download2.php")},segment:"download"},{style:"btn-link",sizeStyle:"col-1 btn-container-sm",autoId:"noThanksBtn",text:Strings.translateString("No Thanks"),closeOnClick:!0,segment:"noThanks"}]}):bg.get("LPContentScriptFeatures").secondary_onboarding_visible&&
LPProxy.getAccountClass()===Constants.USER_PREMIUM_TRIAL?LPPlatform.showSecondaryOnboarding():LPPlatform.showIntroTutorial()})})};b.initialize=function(a){try{bg.sendLpImprove("user_vault_opened");d.body.removeAttribute("class");Topics.get(Topics.REFRESH_DATA).publish();$(".leftMenuItem").removeClass("selected");LPProxy.getPreference("gridView")||b.displayAsList();LPProxy.getPreference("compactView")&&b.displayCompact();this.firstTimeLogin();E.attr("title","Maximize Menu");if(LPFeatures.allowGift()){var c=
$("#specialOfferMenu");c.show();c.bind("click",function(){bg.openURL(LPProxy.getBaseURL()+"gift.php")})}VaultLicenseExpiration.initialize();gb();hb();$("#vaultFooter").addClass("disabled");LPFeatures.allowTryFamilies()&&$("#lp-try-families").show();LPFeatures.isUpgradeButtonTestEnabled()&&ib()}catch(k){LPPlatform.logException(k)}finally{var g=$("#vaultLoadingOverlay");LPTools.getOption(a,"fadeIn",!1)?(g.addClass("fadeIn"),setTimeout(function(){g.addClass("loaded")},500)):g.addClass("loaded");l.addClass("loaded")}};
var hb=function(){bg.LPPartner&&bg.LPPartner.getPartnerInfo&&bg.LPPartner.getPartnerInfo(function(a){a?($("#logoPartner").attr("src",a.logoWhiteUrl).addClass(a.classWhite),$("#logoPartnerContainer").show()):$("#logoPartnerContainer").hide()})},Ka=function(){$("#inProgressMigration").show();bg&&bg.clear_badge&&bg.clear_badge();var a=$("#inProgressMigration").find(".progress-bar");Migrator.executeMigrations(function(c,b){a.css("width",Math.floor(c/b*100)+"%")})},ib=function(){"undefined"!==typeof bg&&
function(){var a=LPProxy.getAccountClass();return a===Constants.USER_FREE||a===Constants.USER_PREMIUM_TRIAL}()&&$("#upgradeButton").addClass("headerButtonActive").click(function(){bg.sendLpImprove("upgrade_button_vault_click");LPPlatform.purchasePremium()})},gb=function(){var a=function(a){b.openReceivedShareCenter(function(){var c=LPProxy.getPendingRecievedShare(a);c&&b.openAcceptShareDialog(c)})},c=function(a){b.openReceivedShareCenter(function(){var c=LPProxy.getPendingRecievedShare(a);c&&c.reject()})};
return function(){var g=LPTools.getURLParams();LPPlatform.setIntroTutorialDisable(!1);for(var d in g){var f=g[d];"cmd"===d&&(d=f);switch(d){case "opengoogleauth":case "opensettings":Topics.get(Topics.EDIT_SETTINGS).publish();break;case "openhistory":LPProxy.openHistory();break;case "openbookmarklets":LPProxy.openBookmarklets();break;case "linkpersonal":b.openLinkAccountDialog();break;case "unlinkpersonal":b.unlinkAccount();break;case "sharedfolder":case "sf":b.openSharingCenter();break;case "sfadd":b.openSharingCenter();
b.openCreateSharedFolderDialog();break;case "sfadduser":b.openSharingCenter();if(!g.shareid)break;(f=LPProxy.getAllSharedGroupModelsByID()[g.shareid])&&Topics.get(Topics.EDIT_SHARED_FOLDER).publish(f);break;case "sfaddsite":b.openSharingCenter();if(!g.shareid)break;(f=LPProxy.getAllSharedGroupModelsByID()[g.shareid])&&f._shareInfo.name&&b.openSiteDialog({saveOptions:{source:"vault"},defaultData:{group:"Shared-"+f._shareInfo.name}});break;case "addidentity":b.openManageIdentities();b.openIdentityDialog();
break;case "showdeleted":b.openDeletedItems();break;case "viewcreditmon":b.openCreditMonitoring();break;case "share":var e=[];f=f.split(",");for(var l=0,n=f.length;l<n;++l){var p=f[l],m=LPProxy.getSiteModel(p);m||(m=LPProxy.getNoteModel(p));m&&e.push(m)}0<e.length&&b.openShareDialog(e);break;case "ffid":case "edit":LPProxy.getSiteModel(f)?b.openSiteDialog({vaultItem:f}):LPProxy.getNoteModel(f)?b.openNoteDialog({vaultItem:f}):LPProxy.getFormFillModel(f)&&b.openFormFillDialog({vaultItem:f});break;case "acceptshare":a(f);
break;case "rejectshare":c(f);break;case "omsstart":LPPlatform.setIntroTutorialDisable(!0)}}if(null===h)switch(g.view){case "emergencyAccess":I.show();break;case "emergencyAccessOthers":J.show();break;default:q.all.show()}}}(),La=function(a){if(a){a=a.getAllSubGroupsIncludingFavorites(!0);for(var c=[],b=0,d=a.length;b<d;++b){var f=a[b];f.isExpanded()&&c.push(f._model.getName())}LPPlatform.setOpenGroups(c)}},jb=function(a){var c=$(".securityScore");c.text(null!==a?Math.round(a)+"%":"");"undefined"!==
typeof a?c.parents(".menuIcon").addClass("score"):c.parents(".menuIcon").removeClass("score")};b.toggleInProgressOverlay=function(){bb.toggle()};var V=function(a,c){0<c?(a.text(c),a.show()):a.hide()},kb=function(){var a=!1;return function(){if(!a)for(var c=LPProxy.getEmergencyAccessRecipientModels(),b=0,d=c.length;b<d;++b){var f=c[b];if(f.allowedAccess()||f.hasRequestedAccess()){dialogs.denyEmergencyAccess.open({sharee:f});a=!0;break}}}}();b.openVault=function(){q.all.show()};b.openNotes=function(){q.notes.show()};
b.openFormFills=function(){q.formFill.show()};b.toggleAdvancedMenu=function(a){da.toggleClass("selected");Q.toggle("fast");ba.toggle();G(a)};b.clear=function(){u&&(u.destruct(),u=null);$(d.body).addClass("loggedout");LPPlatform.shouldShowVaultLoginButton()&&$(d.body).addClass(LPPlatform.canBackgroundOpenPopover()?"canopenpopover":"cannotopenpopover");$("#vaultLoadingOverlay").removeClass("loaded fadeIn");v.val("");C();w=m=F=T=h=null};b.maximizeLeftMenu=function(){l.addClass("maximized");E.addClass("opened");
E.attr("title",Strings.translateString("Minimize"));LPProxy.setPreferences("leftMenuMaximize",!0);setTimeout(Topics.get(Topics.VAULT_LEFT_MENU_TOGGLE).publish,400)};b.minimizeLeftMenu=function(){l.removeClass("maximized");E.removeClass("opened");E.attr("title",Strings.translateString("Maximize"));LPProxy.setPreferences("leftMenuMaximize",!1);setTimeout(Topics.get(Topics.VAULT_LEFT_MENU_TOGGLE).publish,400)};b.toggleLeftMenu=function(){l.hasClass("maximized")?b.minimizeLeftMenu():b.maximizeLeftMenu()};
b.addSource=function(a){a?a.saveOptions&&a.saveOptions.source||(a.saveOptions={source:"vault"}):a={saveOptions:{source:"vault"}};return a};b.openSiteDialog=function(a){dialogs.site.open(b.addSource(a))};b.openNoteDialog=function(a){dialogs.note.open(b.addSource(a))};b.openFormFillDialog=function(a){dialogs.formFill.open(b.addSource(a))};b.openFolderDialog=function(a,c){dialogs.folder.open({vaultItem:a,defaultData:{groupParent:c?c.getName():""},groups:m.getAllSubGroups()})};b.openTryFamiliesDialog=
function(a,c){a=a||!1;bg.sendLpImprove("try_families_lightbox_shown",c?{origin:c}:{});dialogs.tryFamilies.open({forceAccepted:a})};b.openUpgradeFamiliesForFolderSharingDialog=function(a){a={forceAccepted:a||!1};bg.sendLpImprove("shared_folder_families_lightbox_shown");dialogs.upgradeFamiliesForFolderSharing.open(a)};b.openFamiliesInvitationDialog=function(a){LPProxy.getFamiliesInvitations({params:{},success:function(c){0<c.length?(c.sort(function(a,c){return new Date(c.date)-new Date(a.date)}),dialogs.familiesInvitation.open({invitations:c,
callback:a})):a(!1)},error:function(){a(!1)}})};var X=function(){var a=LPProxy.getAccountClass();return a===Constants.USER_FREE||a===Constants.USER_PREMIUM_TRIAL||a===Constants.USER_PREMIUM},Ma=function(){var a=bg.localStorage_getItem("lp_families_dialog_snooze_timestamp"),c=bg.localStorage_getItem("lp_families_dialog_snooze_count");return a&&parseInt(a)>Date.now()&&c&&"1"===c},Na=function(){var a=bg.localStorage_getItem("lp_try_families_dialog_declined"),c=bg.localStorage_getItem("lp_families_dialog_snooze_count");
c=c&&1<parseInt(c);return a||c};b.openCreateSharedFolderDialog=function(a,c){!LPProxy.isLegacyPremium()&&X()&&LPFeatures.allowTryFamilies()&&!LPProxy.isFamiliesTrialStarted()?b.openUpgradeFamiliesForFolderSharingDialog(!1):LPProxy.isFamilyUser()&&bg.get("LPContentScriptFeatures").family_shared_folders_enabled?dialogs.familiesSharedFolder.open({group:a,children:c}):LPProxy.getAccountClass()===Constants.USER_FREE?(bg.sendLpImprove("upgrade_to_premium_lightbox_shown"),dialogs.upgradePremium.open({upgradeText:[LPTools.createElement("h1",
"upgradeDialogHeader",Strings.translateString("Need to share passwords with family or friends?")),LPTools.createElement("p","dialogText",Strings.translateString("Go Premium now to create a Shared Folder, invite family or friends, and fill the folder with passwords and notes. Give up to 5 people access to the Shared Folder. Changes are synced automatically, and you can assign read-only access. Go Premium now to create a Shared Folder!"))]})):dialogs.createSharedFolder.open({group:a,children:c})};b.openSettingsDialog=
function(){null===T&&(AccountSettingsService.call(function(a){T=a;b.openSettingsDialog()},function(){Notifications.displayErrorMessage("Could not retrieve account settings!")}),Topics.get(Topics.DIALOG_LOADING).publish());dialogs.settings.open(T)};b.openLinkAccountDialog=function(){LPProxy.callAcctsIFrameCommand("linkpersonal")};b.openVerifyLinkedAccountDialog=function(){LPProxy.callAcctsIFrameCommand("verifypersonal")};b.unlinkAccount=function(){var a=LPProxy.getLinkedAccount();a&&a.unlink()};b.toggleCollapseAll=
function(){var a=!1;Topics.get(Topics.ALL_COLLAPSED).subscribe(function(){a=!0;R.addClass("selected");R.attr("title",Strings.Vault.EXPAND_ALL)});Topics.get(Topics.ALL_EXPANDED).subscribe(function(){a=!1;R.removeClass("selected");R.attr("title",Strings.Vault.COLLAPSE_ALL)});return function(){a?(Topics.get(Topics.EXPAND_ALL).publish(),Topics.get(Topics.ALL_EXPANDED).publish()):(Topics.get(Topics.COLLAPSE_ALL).publish(),Topics.get(Topics.ALL_COLLAPSED).publish())}}();b.toggleSize=function(){var a=!1;
b.displayLarge=function(){Topics.get(Topics.DISPLAY_LARGE).publish();a=!1;S.removeClass("selected");S.attr("title",Strings.Vault.COMPACT_VIEW);LPProxy.setPreferences("compactView",!1)};b.displayCompact=function(){Topics.get(Topics.DISPLAY_COMPACT).publish();a=!0;S.addClass("selected");S.attr("title",Strings.Vault.LARGE_VIEW);LPProxy.setPreferences("compactView",!0)};return function(){a?(b.displayLarge(),bg.lpevent(U?"v_grd_lrg":"v_lst_lrg")):(b.displayCompact(),bg.lpevent(U?"v_grd_cmp":"v_lst_cmp"))}}();
b.displayAsGrid=function(){Topics.get(Topics.DISPLAY_GRID).publish();xa.addClass("selected");ya.removeClass("selected");LPProxy.setPreferences("gridView",!0);U=!0};b.displayAsList=function(){Topics.get(Topics.DISPLAY_LIST).publish();ya.addClass("selected");xa.removeClass("selected");LPProxy.setPreferences("gridView",!1);U=!1};b.search=function(a){h&&h.search(a)};var Oa=function(a,c){switch(c){case A:a.sortByName(!0);break;case B:a.sortByName(!1);break;case oa:a.sortByFolder(!0);break;case pa:a.sortByFolder(!1);
break;case P:a.sortItemsByMostRecent();break;case qa:case sa:a.sortByEmail(!0);break;case ra:case ta:a.sortByEmail(!1)}};b.sort=function(a){db.text(a);Oa(h.getContainer(),a);h.setSortOrder(a)};b.showMoreOptionsMenu=function(){Ba.show("fast")};b.hideMoreOptionsMenu=function(){Ba.hide("fast")};b.openEmergencyAccess=function(){ha.show()};b.openEmergencyAccessTrusted=function(){ha.show(I)};b.openEmergencyAccessTrusting=function(){ha.show(J)};b.openRestrictedEmergencyAccess=function(){dialogs.restrictedEmergencyAccess.open()};
b.openSharingCenter=function(a){N.show()};b.openReceivedShareCenter=function(a){N.show(K,a)};b.openSentShareCenter=function(a){N.show(L,a)};b.openSharedFolderCenter=function(a){N.show(z,a)};var M=!1,ia=function(a){z.getContainer().applyFilter({showEmptyGroups:!1,multiSelect:!1,func:function(a){return!a._model.isDeleted()}},a);M=!1},ja=function(a){z.getContainer().applyFilter({showEmptyGroups:!1,multiSelect:!1,func:function(a){return!0}},a);M=!0};b.openAcceptShareDialog=function(a){dialogs.acceptShare.open({vaultItem:a,
groups:m.getAllSubGroups()})};b.openShareDialog=function(a){LPTools.openShareDialog(a)};b.openSharedFolderDialog=function(a,c){LPProxy.isFamilyUser()&&a._shareInfo.cid!==Constants.UNAFFILIATED_COMPANY_ID&&bg.get("LPContentScriptFeatures").family_shared_folders_enabled?dialogs.familiesSharedFolder.open({folder:a,members:c}):dialogs.sharedFolder.open(a,c)};b.openSharedFolderAccessDialog=function(a){dialogs.sharedfolderAccess.open(a)};b.openRestrictedSharingDialog=function(){dialogs.restrictedSharing.open()};
b.closeShareDialog=function(){dialogs.share.close(!0)};b.openManageIdentities=function(){Ha.show()};b.openIdentityDialog=function(a){dialogs.identity.open(a)};b.enableIdentity=function(a){null!==F&&F!==a&&(F.disable(),LPProxy.enableIdentity(a));F=a;a=m?m._filter:null;null!==m&&(La(m),m.destruct());var c=LPProxy.getAllItems({identity:F});c=new GridListContainer(c,{separateItems:!0,separateFavorites:!0,stickyFolders:!0,ignoreFilterOnSearch:!0,keyboardNavigation:!0,stickyFolderParent:d.getElementById("main"),
folderStateChange:La});var b=LPPlatform.getOpenGroups();if(null!==b){for(var k=!0,f=c.getAllSubGroupsIncludingFavorites(!0),e=0,h=f.length;e<h;++e){var n=f[e];b[n._model.getName()]?(n.expand(),k=!1):n.collapse()}k&&Topics.get(Topics.ALL_COLLAPSED).publish()}Oa(c,q.all.getSortOrder());c.initialize(d.getElementById("vaultContent"),t);c.applyFilter(a);Y(c);for(var l in q)q[l].setContainer(c);m=c};b.openCreditMonitoring=function(a){W.show()};b.openCreateCreditMonitoringDialog=function(){dialogs.createCreditMonitoring.open()};
b.openDeletedItems=function(a){fa.show()};b.showAdPane=function(){if("undefined"!==typeof bg.is_edge?bg.is_edge():-1!==navigator.userAgent.indexOf(" Edge/"))return!1;var a=bg.get("g_prompts").improve?1:0,c=d.getElementById("ad"),b=d.createElement("iframe");b.setAttribute("src",na.getPartnerURL(LPProxy.getBaseURL()+"ads.php?nobr=1&noga=1&rand="+Math.floor(1E3*Math.random())+"&v="+LPProxy.getVersion())+"&g_lpImprove="+a);b.setAttribute("sandbox","allow-scripts allow-same-origin allow-popups");c.appendChild(b);
l.addClass("freeUser");setInterval(function(){b.setAttribute("src",na.getPartnerURL(LPProxy.getBaseURL()+"ads.php?v=4.0&nobr=1&noga=1&rand="+Math.floor(1E3*Math.random())+"&v="+LPProxy.getVersion())+"&g_lpImprove="+a)},3E5)};b.firstTimeLogin=function(){if(bg.get("g_first_time_login")){var a=LPTools.createElement("iframe",{"class":"displaynone",src:LPProxy.getBaseURL()+"lppixel.php"});$("#main").after(a)}};l.bind("click",function(){la()});$("#vault").bind("click",function(){C();la()});$("#loginButton").bind("click",
function(){bg.open_login()});LPPlatform.addEventListener(window,"unload",function(){Topics.get(Topics.CLEAR_DATA).publish()});v.LP_addSearchHandlers("inputLight",function(a){b.search(a)});v.bind("keydown",function(a){if(40===(a.keyCode||a.which)){var c=h.getContainer();c&&(c=c.getAllChildrenOrdered(),0<c.length&&(c[0].focus(),a.preventDefault(),a.stopPropagation()))}});$("#orderOption").bind("click",function(a){Aa.toggle("fast");w=Aa;LPTools.addKeyBoardNavigation(ea.children);G(a)});$("#actions").bind("click",
function(a){if(null===w||w.get(0).parentElement!==Ca){var c=h.createSelectionContextMenu();Ca.appendChild(c);c.removeAttribute("style");w=$(c);w.show("fast")}else O();G(a)});$(".sharingMenuItem").bind("click",function(){LPProxy.setCompanyExpiration();bg.sendLpImprove("sharing_center_vault_click");!LPProxy.isLegacyPremium()&&X()&&LPFeatures.allowTryFamilies()&&!Na()&&!Ma()&&LPProxy.isFamiliesTrialStarted()&&b.openTryFamiliesDialog(!1,"sharing_menu_item");b.openSharingCenter()});da.bind("click",b.toggleAdvancedMenu);
ba.bind("click",ka);E.bind("click",b.toggleLeftMenu);LPPlatform.addEventListener(d.getElementById("settingsMenuItem"),"click",function(){Topics.get(Topics.EDIT_SETTINGS).publish({source:"sidebar"})});$("#linkAccountMenuItem").bind("click",function(){b.openLinkAccountDialog()});$("#verifyLinkedAccountMenuItem").bind("click",function(){b.openVerifyLinkedAccountDialog()});Q.on("click",".toolsMenuItem.subMenuOption",function(){return!1});Q.on("click",".toolsMenuItem",ka);x.bind("mouseenter",Ja);x.bind("mouseleave",
Ia);x.bind("touchstart",function(a){x.unbind("mousenter");x.unbind("mouseleave");x.hasClass("open")||(Ja(),a.preventDefault())});LPPlatform.addEventListener(d.getElementById("collapseAllToggle"),"click",function(){b.toggleCollapseAll()});LPPlatform.addEventListener(d.getElementById("sizeToggle"),"click",function(){b.toggleSize()});LPPlatform.addEventListener(d.getElementById("gridButton"),"click",function(){b.displayAsGrid()});LPPlatform.addEventListener(d.getElementById("listButton"),"click",function(){b.displayAsList()});
LPPlatform.addEventListener(d.getElementById("userMenuContainer"),"click",function(a){Da.toggleClass("selected");ca.toggle("fast");G(a)});LPPlatform.addEventListener(d.getElementById("manageIdentitiesMenuItem"),"click",function(){b.openManageIdentities()});LPPlatform.addEventListener(d.getElementById("creditMonitoringMenuItem"),"click",function(){b.openCreditMonitoring()});-1!=navigator.userAgent.indexOf(" Edge/")&&d.getElementById("creditMonitoringMenuItem").remove();LPPlatform.addEventListener(d.getElementById("openTourMenuItem"),
"click",function(){LPPlatform.openTour(!0)});$(".toolsMenuItem.subMenuOption").bind("click",function(a){$(a.target.parentElement.nextElementSibling).toggle("fast");$(a.target).toggleClass("selected");G(a)});LPPlatform.addEventListener(d.getElementById("toolsImport"),"click",function(){LPProxy["import"]()});LPPlatform.addEventListener(d.getElementById("toolsExport"),"click",function(){LPProxy["export"]()});LPPlatform.addEventListener(d.getElementById("toolsOpenFavorites"),"click",function(){LPProxy.openAllFavorites("vault")});
LPPlatform.addEventListener(d.getElementById("bookmarkletsMenuItem"),"click",function(){LPProxy.openBookmarklets()});LPPlatform.addEventListener(d.getElementById("otpMenuItem"),"click",function(){$(this).attr("href",bg.get("base_url")+"otp.php")});LPPlatform.addEventListener(d.getElementById("historyMenuItem"),"click",function(){LPProxy.openHistory()});LPPlatform.addEventListener(d.getElementById("deletedMenuItem"),"click",function(){b.openDeletedItems()});LPPlatform.addEventListener(d.getElementById("generateSharingKeys"),
"click",function(){bg.lpevent("v_gsk");dialogs.sharingKey.open()});$("#generateSharingKeys").hide();LPPlatform.addEventListener(d.getElementById("featureManager"),"click",function(){bg.openURL(window.location.origin+"/lastpass/index.html#/feature-manager")});LPPlatform.addEventListener(d.getElementById("generatePasswordMenuItem"),"click",function(){bg.lpevent("v_gpw");(bg.get("LPContentScriptFeatures").better_generate_password_enabled?dialogs.betterGeneratePassword:dialogs.generatePassword).open({fillGenerated:!1,
saveOptions:{source:"vault"}})});$("#removedLinkedAccountMenuItem").bind("click",function(){b.unlinkAccount()});$("#tryEnterprise").bind("click",function(){dialogs.enterpriseTrial.open()});$("#emergencyAccessMenuItem").bind("click",function(){LPProxy.setCompanyExpiration();var a=0<bg.get("g_emer_sharers").length||0<bg.get("g_emer_sharees").length;!LPProxy.isFreeUser()&&!LPProxy.isExpiredFamilyUser()||a?(bg.sendLpImprove("emergency_access_vault_click"),b.openEmergencyAccess()):(bg.sendLpImprove("restricted_emergency_access_lightbox_shown"),
b.openRestrictedEmergencyAccess())});$(".securityMenuItem").bind("click",function(){bg.lpevent("v_sec");bg.openseccheck()});$("#adminConsoleMenuItem").bind("click",function(){bg.lpevent("v_oec");bg.openentconsole()});$("#more-options-refer-a-friend").bind("click",function(){bg.sendLpImprove("refer_a_friend_more_options_click")});$("#more-options-go-premium").bind("click",function(){bg.sendLpImprove("go_premium_more_options_vault_click")});$("#familyAdminConsoleMenuItem").bind("click",function(){bg.lpevent("v_ofc");
bg.openFamilyConsole();bg.sendLpImprove("families_manage_families_click")});$("#lp-try-families").bind("click",function(){X()&&LPFeatures.allowTryFamilies()&&b.openTryFamiliesDialog(!1,"try_families_submenu_item")});Topics.get(Topics.ITEMS_DESELECTED).subscribe(function(){b.hideMoreOptionsMenu()});Topics.get(Topics.ITEMS_SELECTED).subscribe(function(){b.showMoreOptionsMenu()});Topics.get(Topics.SELECT_COUNT_CHANGE).subscribe(function(a){0<a&&(a=Strings.translateString("%1 items selected",a),$("#selectedItemCounter").text(a))});
Topics.get(Topics.CONTEXT_MENU).subscribe(function(a,c){c.parentElement!==d.body&&d.body.appendChild(c);w=LPTools.displayContextMenu(a,c)});Topics.get(Topics.CONTEXT_CLOSE).subscribe(function(){O()});Topics.get(Topics.ITEM_SHARE).subscribe(function(a){LPFeatures.allowOmarDrawer()&&1===a.length?window.location.hash="/drawers/(drawer:edit-item/"+a[0]._data.aid+"/sharing)":b.openShareDialog(a)});Topics.get(Topics.IDENTITY_ENABLE).subscribe(function(a){b.enableIdentity(a);Y(m)});Topics.get(Topics.CLEAR_DATA).subscribe(function(){b.clear();
Dialog.prototype.closeAllDialogs(!0);bg.closeSettingsIframe()});Topics.get(Topics.LOGIN).subscribe(function(a){lb();b.initialize(a);Dialog.prototype.closeAllDialogs(!0);b.initializeWelcomeDialogs()});Topics.get(Topics.REQUEST_SUCCESS).subscribe(function(a){LPTools.getOption(a,"incrementAccountsVersion",!1)&&C()});(function(){var a=function(a,b,d){v.val("");C();m.addChild(a.newDisplayObject(),b,d);Y(m)};Topics.get(Topics.SITE_ADDED).subscribe(a);Topics.get(Topics.NOTE_ADDED).subscribe(a);Topics.get(Topics.FORM_FILL_ADDED).subscribe(a);
Topics.get(Topics.APPLICATION_ADDED).subscribe(a)})();Topics.get(Topics.ITEM_REMOVED).subscribe(function(){Y(m)});Topics.get(Topics.EDIT_SHARED_FOLDER_ACCESS).subscribe(function(a){b.openSharedFolderAccessDialog(a)});Topics.get(Topics.EDIT_SITE).subscribe(function(a){LPFeatures.allowOmarDrawer()?window.location.hash="/drawers/(drawer:edit-item/"+a.vaultItem._data.aid+")":b.openSiteDialog(a)});Topics.get(Topics.EDIT_NOTE).subscribe(function(a){LPFeatures.allowOmarDrawer()?window.location.hash="/drawers/(drawer:edit-item/"+
a.vaultItem._data.aid+")":b.openNoteDialog(a)});Topics.get(Topics.EDIT_FORM_FILL).subscribe(function(a){b.openFormFillDialog(a)});Topics.get(Topics.EDIT_APPLICATION).subscribe(function(a){dialogs.application.open(a)});Topics.get(Topics.EDIT_SETTINGS).subscribe(function(a){bg.sendLpImprove("viewvaultsettings",{source:a&&a.source?a.source:""});params={};bg.get("gRecovery")&&(params.recovery=bg.get("gRecovery"));a&&a.defaulttab&&(params.defaulttab=a.defaulttab);LPProxy.callAcctsIFrameCommand("settings",
null,params)});Topics.get(Topics.EDIT_IDENTITY).subscribe(function(a){b.openIdentityDialog(a)});Topics.get(Topics.ACCEPT_SHARE).subscribe(function(a){b.openAcceptShareDialog(a)});Topics.get(Topics.RENAME_FOLDER).subscribe(function(a){b.openFolderDialog(a)});Topics.get(Topics.CREATE_SUB_FOLDER).subscribe(function(a){b.openFolderDialog(null,a)});Topics.get(Topics.GROUP_ADDED).subscribe(function(a,c){v.val("");C();m.addChild(a.newDisplayObject(),c);a instanceof SharedGroup&&(c=z.getContainer(),null!==
c&&(a=new SharedFolderItem(a),c.addChild(a)))});Topics.get(Topics.ESCAPE).subscribe(function(a){(a=Dialog.prototype.getCurrentDialog())&&a.close();C();la()});Topics.get(Topics.EDIT_SHARED_FOLDER).subscribe(function(a,c){b.openSharedFolderDialog(a,c)});Topics.get(Topics.IDENTITY_ADDED).subscribe(function(a){Ha.getContainer().addChild(a.newDisplayObject())});b.refreshVault=function(){LPProxy.initializeModel();kb();u=LPProxy.getUser();u.initialize(ca,$("#userMenuText"));LPTools.parseUserSpecificMenu(d.getElementById("tools"),
u._accountClass);LPTools.parseUserSpecificMenu(d.getElementById("leftMenu"),u._accountClass);var a=LPProxy.getAccountClass(),c=LPProxy.isPremiumAsAPerk(),g=LPProxy.isLegacyPremium(),e=d.getElementById("sharedFoldersMenuItem").parentElement;a===Constants.USER_FREE?($("#emptySharedFoldersIcon .tourText").append(LPTools.createElement("a",{"class":"nbtn rbtn dynamicWidth",href:LPProxy.getBaseURL()+"go-premium",target:"_blank"},Strings.translateString("Upgrade to Premium"))),e.parentElement.appendChild(e)):
a===Constants.USER_PREMIUM&&c&&!g&&d.getElementById("sharedFoldersMenuItem").remove();$(e.parentElement).children().last().addClass("last");VaultState.setIdentities(u._identities);LPProxy.enableCurrentIdentity(u._identities);u.isFreeOrTrial()?b.showAdPane():l.removeClass("freeUser");LPProxy.getSecurityChallengeScore(jb);Dialog.prototype.closeInProcessDialogs();VaultItemDialog.prototype.refreshOpenDialogs();Topics.get(Topics.REFRESH_PREFERENCES).publish();O()};Topics.get(Topics.REFRESH_DATA).subscribe(b.refreshVault);
Topics.get(Topics.UPDATE_NOTIFICATION_COUNT).subscribe(function(a){h&&h.updateNotificationCount("number"===typeof a?a:1)});Topics.get(Topics.ACCOUNT_LINKED).subscribe(function(a){$("#linkAccountMenuItem").LP_hide();$("#verifyLinkedAccountMenuItem").LP_hide();$("#removedLinkedAccountMenuItem").LP_show()});Topics.get(Topics.ACCOUNT_LINKED_NEEDS_VERIFICATION).subscribe(function(a){$("#linkAccountMenuItem").LP_hide();$("#verifyLinkedAccountMenuItem").LP_show();$("#removedLinkedAccountMenuItem").LP_hide()});
Topics.get(Topics.ACCOUNT_UNLINKED).subscribe(function(a){$("#linkAccountMenuItem").LP_show();$("#verifyLinkedAccountMenuItem").LP_hide();$("#removedLinkedAccountMenuItem").LP_hide()});Topics.get(Topics.CREATE_SHARED_FOLDER).subscribe(function(a,c){b.openCreateSharedFolderDialog(a,c)});Topics.get(Topics.REPROMPT).subscribe(function(a){dialogs.reprompt.open({successCallback:a})});Topics.get(Topics.CONFIRM).subscribe(function(a){dialogs.confirmation.open(a)});Topics.get(Topics.EMERGENCY_RECIPIENT_ADDED).subscribe(function(a){I.getContainer().addChild(a.newDisplayObject())});
Topics.get(Topics.EDIT_EMERGENCY_RECIPIENT).subscribe(function(a){dialogs.addEmergencyAccess.open({vaultItem:a})});Topics.get(Topics.REAPPLY_SEARCH).subscribe(function(a,c){var b=v.val();b&&a.applySearch(b,c)});Topics.get(Topics.ENROLLED_CREDIT_MONITORING).subscribe(function(){W.refresh()});Topics.get(Topics.ITEM_SHARED).subscribe(function(a){L.refresh()});Topics.get(Topics.REFRESH_PREFERENCES).subscribe(function(){LPFeatures.updateFeatures({"import":!0,noexport:!1,share:!0,share_onlyfolders:!1,show_notes:!0,
bookmarklets:!0,hideidentities:!1,showcredmon:!0,link_personal:!0,show_formfills:!0});LPProxy.hasReceivedShares()?l.removeClass("noReceivedShares"):l.addClass("noReceivedShares");switch(h){case L:LPFeatures.allowIndividualSharing()||(N.clear(),q.all.show(),dialogs.alert.open({title:Strings.translateString("Policy Update"),text:Strings.translateString("Your enterprise has prohibited individual sharing.")}));break;case z:LPFeatures.allowSharedFolders()||(q.all.show(),dialogs.alert.open({title:Strings.translateString("Policy Update"),
text:Strings.translateString("Your enterprise has prohibited sharing.")}))}});Strings.translate(d.body);$("input,textarea").prop("spellcheck",!1);if(LPFeatures.allowNewSettings()){var ma=document.getElementById("new-settings-iframe");ma.src=LPProxy.getBaseURL()+"newvault/lp-vault/settings.html";ma.addEventListener("load",function(){ma.contentWindow.postMessage({localkey:parent.g_local_key},LPProxy.getBaseURL())})}Topics.get(Topics.INTRO_TOURS_LOADED).subscribe(function(a){a=LPProxy.seenVaultPostFamilies();
var c=LPProxy.predatesFamilies(),d=LPFeatures.allowTryFamilies(),e=LPProxy.isFamiliesTrialStarted();!d||!c||a||Na()||Ma()||!X()||e||b.openTryFamiliesDialog(!1,"first_vault_entry")});Notifications.initialize();var mb=function(a,c,b){b=LPTools.createElement("div",$.extend(b,{"class":"leftMenuItem",id:b.id}));b.appendChild(c);b.appendChild(LPTools.createElement("span",{"class":"menuText"},a));return $(b)},Pa=function(a,b){if(a.types){var c=b.filter(function(b){return-1<a.types.indexOf(b.id)});return function(a){for(var b=
0;b<c.length;++b){var d=c[b];d=a instanceof GroupDisplay?!0:a._model.getRecordType()===d.recordType;if(d)return!0}return!1}}return function(a){return!(a instanceof FormFillDisplay)}},q={},Y=function(a){if(LPFeatures.allowOmarIA()){var b=document.getElementById("leftMenuItemsContainer");LPTools.removeDOMChildren(b);var e=LPProxy.getRecordConfig(),k=!1,f=!1,l=function(a){k&&(b.appendChild(LPTools.createElement("div","leftMenuItemsDivider")),k=!1);var c=q[a.id].getElement();b.appendChild(c);null!=a.user&&
c.setAttribute("user",a.user)},m=function(b,c){if(Array.isArray(b))k=0<c,b.forEach(m);else if(b=LPProxy.getConfigViewObject(b),b.default){if(b.types){c=LPProxy.getConfigTypeObject(b.types[0]);var d=bg.get("g_prefoverrides").noformfill?bg.get("g_prefoverrides").noformfill:[];if(-1===LPProxy.getAllModelTypes().indexOf(c.recordType)&&"Account"!==c.recordType&&(-1!==d.indexOf("0")||-1!==d.indexOf(c.enterprisePolicyId)))return}l(b)}else c=Pa(b,e.types),d=a._filter,a.applyFilter({func:c},{checkForStateChange:!1}),
0<a.getItemChildren().length?l(b):q[b.id]===h&&(f=!0),a.applyFilter(d,{checkForStateChange:!1})};k=!0;e.viewConfig.forEach(m);LPTools.parseUserSpecificMenu(d.getElementById("leftMenu"),LPProxy.getAccountClass());f&&q.all.show();LPFeatures.hide_cloud_apps_policy_enabled()&&$("#cloud-apps").LP_hide()}},nb=function(a){var b=LPProxy.getRecordConfig();return LPTools.createElement("i",{"class":["menuIcon",a.types&&0<a.types.length?b.icons[a.types[0]]:b.icons.all]})},lb=function(){if(LPFeatures.allowOmarIA()){var a=
LPProxy.getRecordConfig();a.views.forEach(function(b){q[b.id]=new y({filter:{showEmptyGroups:!0,func:Pa(b,a.types)},sortOptions:D,menuElement:mb(Strings.translateString(b.name),nb(b),{id:b.id}),bodyState:"vaultContent "+b.id,scrollParent:t,title:Strings.translateString(b.name),addMenu:[new r({text:"ADD_ITEM",autoId:"vaultAddItemButton",func:function(){var c,d=bg.get("g_prefoverrides").noformfill?bg.get("g_prefoverrides").noformfill:[];b.types&&-1===d.indexOf("0")?a.types.forEach(function(e){if(e.id===
b.types[0])switch(c=e.recordType,c){case a.TYPE.Password:dialogs.site.open();break;case a.TYPE.Custom:dialogs.addItem.open({isExpanded:!0});break;default:-1!==d.indexOf(e.enterprisePolicyId)?dialogs.addItem.open():dialogs.note.open({defaultData:{notetype:c,language:Note.prototype.isValidLanguage(navigator.language)?navigator.language:"en-US"}})}}):dialogs.addItem.open()}}),aa]})})}else q.all=new y({filter:{showEmptyGroups:!0,func:function(a){return a instanceof AccountBaseDisplay||a instanceof ApplicationDisplay||
a instanceof GroupDisplay}},sortOptions:D,menuElement:$("#vaultMenuItem"),bodyState:"vaultContent site",scrollParent:t,title:Strings.translateString("Sites"),addMenu:[Va,Z,H,aa]}),q.notes=new y({filter:{showEmptyGroups:!1,func:function(a){return a instanceof NoteDisplay||a instanceof GroupDisplay}},sortOptions:D,menuElement:$("#notesMenuItem"),bodyState:"vaultContent note",scrollParent:t,title:Strings.translateString("Secure Notes"),addMenu:[Z,H,aa]}),q.formFills=new y({filter:{showEmptyGroups:!1,
multiSelect:!1,hasFolderView:!1,func:function(a){return a instanceof FormFillDisplay}},sortOptions:Qa,menuElement:$("#formFillMenuItem"),bodyState:"vaultContent formFill",scrollParent:t,title:Strings.translateString("Form Fills"),addMenu:[Wa]});LPFeatures.isDogfood()||$("#featureManager").LP_hide();LPFeatures.hide_cloud_apps_policy_enabled()?Ea.LP_hide():Ea.LP_show().bind("click",function(){bg.sendLpImprove("vault_cloud_apps_clicked");bg.openOnNewTab("saml/launch/nopassword?RelayState=/")});LPFeatures.hide_cloud_apps_policy_enabled()?
$("#cloud-apps").LP_hide():$("#cloud-apps").LP_show().bind("click",function(){bg.sendLpImproveCallback("vault_cloud_apps_clicked",function(){window.location.href="/saml/launch/nopassword?RelayState=/"})})}};Topics.get(Topics.INITIALIZED).subscribe(function(){initialize(document,LPVault,BuildVariables)});
//# sourceMappingURL=newvault_vault_js.js.map