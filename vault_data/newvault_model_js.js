"function"!==typeof Object.create&&(Object.create=function(g){function l(){}l.prototype=g;return new l});
(function(){var g=function(g,k){this._data=$.extend(!0,{},g);(this._sharedGroup=k)?(g=this.getTopLevelGroupName(),k.getName()!==g&&(this._data.group=k.getName()+this._data.group.substring(g.length))):!this.useSharePrefix()&&this._data.group&&0===this._data.group.indexOf(this.SHARED_FOLDER_NAME_PREFIX)&&(this._data.group=this._data.group.substring(this.SHARED_FOLDER_NAME_PREFIX.length))};VaultItemBase=function(l,k){this._views=[];g.apply(this,arguments)};VaultItemBase.prototype.refresh=function(l,
k){g.apply(this,arguments);return this}})();VaultItemBase.prototype.defaultFields=function(g,l){l=l||this._data;for(var k in g)void 0===l[k]&&(l[k]=g[k])};VaultItemBase.prototype.SHARED_FOLDER_NAME_PREFIX="Shared-";VaultItemBase.prototype.useSharePrefix=function(){return this.getSharedGroup()?this._sharedGroup.useSharePrefix():!1};VaultItemBase.prototype.getTopLevelGroupName=function(){var g=this._data.group||"",l=g.indexOf("\\");return-1<l?g.substring(0,l):g};
VaultItem=function(){var g={pwprotect:!1};return function(l,k){VaultItemBase.call(this,l,k);this.defaultFields(g)}}();VaultItem.prototype=Object.create(VaultItemBase.prototype);VaultItem.prototype.constructor=VaultItem;
AccountBase=function(){var g={action:"",aid:"0",basic_auth:"0",captcha_id:"",custom_js:"",extra:"",fields:[],group:"",fiid:"",getpw:!1,individualshare:!1,last_touch:"0",method:"",newvalues:[],realm_data:"",sharedfromuid:"",submit_id:"",urid:"0",fav:"0",username:"",password:""};return function(l,k){VaultItem.call(this,l,k);this.defaultFields(g)}}();AccountBase.prototype=Object.create(VaultItem.prototype);AccountBase.prototype.constructor=AccountBase;
AccountBaseWithFields=function(g,l){AccountBase.call(this,g,l)};AccountBaseWithFields.prototype=Object.create(AccountBase.prototype);AccountBaseWithFields.prototype.constructor=AccountBaseWithFields;Account=function(g,l){AccountBaseWithFields.call(this,g,l);this._data.sn=0};Account.prototype=Object.create(AccountBaseWithFields.prototype);Account.prototype.constructor=Account;Account.prototype.getDisplayClass=function(){return AccountDisplay};Account.prototype.TYPE="Account";
Account.prototype.getRecordType=function(){return Account.prototype.TYPE};Group=function(g,l){AccountBase.call(this,g,l);this._data.url="http://group"};Group.prototype=Object.create(AccountBase.prototype);Group.prototype.constructor=Group;Group.prototype.getDisplayClass=function(){return GroupDisplay};Group.prototype.TYPE="Group";DummyGroup=function(g,l){Group.call(this,{group:g},l)};DummyGroup.prototype=Object.create(Group.prototype);DummyGroup.prototype.constructor=DummyGroup;
DummyGroup.prototype.destruct=function(){this._views.forEach(function(g){"function"===typeof g.destruct&&g.destruct()})};DummyGroup.prototype.getDisplayClass=function(){return DummyGroupDisplay};DefaultGroup=function(g){DummyGroup.call(this,g)};DefaultGroup.prototype=Object.create(DummyGroup.prototype);DefaultGroup.prototype.constructor=DefaultGroup;DefaultGroup.prototype.getDisplayClass=function(){return DefaultGroupDisplay};
(function(){var g={accepted:"1",association:"0",associative:"0",can_administer:"1",cgid:"0",deleted:"0",download:"1",give:"1",id:"0",invisible:"0",outside_enterprise:"0",readonly:"0",shareid:"0"},l=function(k,f){this.useSharePrefix()&&0!==this._data.group.indexOf(this.SHARED_FOLDER_NAME_PREFIX)&&(this._data.group=this.SHARED_FOLDER_NAME_PREFIX+this._data.group);this._data.group=this.getTopLevelGroupName();f=f||{};k=LPTools.get_gmt_timestamp();g.create=k;g.last_modified=k;this.defaultFields(g,f);this._shareInfo=
f;this._shareInfo.name=this.getShareGroupName();this._shareInfo.decsharename=this._data.group;this.setID(this._data.aid)};SharedGroup=function(g,f){Group.call(this,g);l.apply(this,arguments)};SharedGroup.prototype=Object.create(Group.prototype);SharedGroup.prototype.constructor=SharedGroup;SharedGroup.prototype.refresh=function(g,f){Group.prototype.refresh.call(this,g);l.apply(this,arguments);return this}})();SharedGroup.prototype.getDisplayClass=function(){return SharedGroupDisplay};
LinkedGroup=function(g,l){SharedGroup.call(this,g,l)};LinkedGroup.prototype=Object.create(SharedGroup.prototype);LinkedGroup.prototype.constructor=LinkedGroup;LinkedGroup.prototype.getDisplayClass=function(){return LinkedGroupDisplay};EmergencyAccessGroup=function(g,l){LinkedGroup.call(this,g,l)};EmergencyAccessGroup.prototype=Object.create(LinkedGroup.prototype);EmergencyAccessGroup.prototype.constructor=EmergencyAccessGroup;EmergencyAccessGroup.prototype.getDisplayClass=function(){return EmergencyAccessGroupDisplay};
(function(){var g=function(g,k,f){this._data.sn=1;this._data.url="http://sn";this._attachments=f||[];g=0;for(k=this._attachments.length;g<k;++g)this._attachments[g].setParentNote(this)};Note=function(l,k,f){AccountBase.call(this,l,k);g.apply(this,arguments)};Note.prototype=Object.create(AccountBase.prototype);Note.prototype.constructor=Note;Note.prototype.refresh=function(l,k,f){AccountBase.prototype.refresh.apply(this,arguments);g.apply(this,arguments);return this}})();
Note.prototype.getDisplayClass=function(){return NoteDisplay};Note.prototype.TYPE="Note";
FormFill=function(){var g={address1:"",address2:"",address3:"",bankacctnum:"",bankname:"",bankroutingnum:"",birthday:"",cccsc:"",ccexp:"",ccissuenum:"",ccname:"",ccnum:"",ccstart:"",city:"",company:"",country:"",country_cc3l:"",country_name:"",county:"",creditmon:"",customfield1alttext:"",customfield1cfid:"0",customfield1text:"",customfield1value:"",customfield2alttext:"",customfield2cfid:"0",customfield2text:"",customfield2value:"",customfield3alttext:"",customfield3cfid:"0",customfield3text:"",
customfield3value:"",deleteext:0,driverlicensenum:"",email:"",eveext:"",evephone:"",evephone3lcc:"",fax:"",fax3lcc:"",faxext:"",ffid:0,firstname:"",firstname2:"",firstname3:"",gender:"",group:"",lastname:"",lastname2:"",lastname3:"",middlename:"",mobileemail:"",mobileext:"",mobilephone:"",mobilephone3lcc:"",notes:"",phone:"",phone3lcc:"",phoneext:"",profilelanguage:"",profilename:"",profiletype:0,ssn:"",state:"",state_name:"",taxid:"",timezone:"",title:"",username:"",zip:""};return function(l,k){VaultItem.call(this,
l,k);this.defaultFields(g);void 0===this._data.decprofilename&&(this._data.decprofilename=LPProxy.decryptMobile(this._data.profilename,!0,this.getKey()))}}();FormFill.prototype=Object.create(VaultItem.prototype);FormFill.prototype.constructor=FormFill;FormFill.prototype.getDisplayClass=function(){return FormFillDisplay};FormFill.prototype.TYPE="FormFill";FormFill.prototype.getRecordType=function(){return FormFill.prototype.TYPE};Attachment=function(g){VaultItemBase.call(this,g);this._filename=null};
Attachment.prototype=Object.create(VaultItemBase.prototype);Attachment.prototype.constructor=Attachment;Attachment.prototype.getDisplayClass=function(){return AttachmentDisplay};Identity=function(g){VaultItemBase.call(this,g);this.defaultFields({iid:"0"});this._enabled=!1;void 0===this._data.deciname&&(this._data.deciname=LPProxy.decrypt(this._data.iname,this.getKey()))};Identity.prototype=Object.create(VaultItemBase.prototype);Identity.prototype.constructor=Identity;
Identity.prototype.getDisplayClass=function(){return IdentityDisplay};AllIdentity=function(){Identity.call(this);this._data.deciname=Strings.translateString("All");this._data.iid=""};AllIdentity.prototype=Object.create(Identity.prototype);AllIdentity.prototype.constructor=AllIdentity;AllIdentity.prototype.getDisplayClass=function(){return AllIdentityDisplay};Application=function(){var g={appaid:"0"};return function(l,k){AccountBaseWithFields.call(this,l,k);this.defaultFields(g);this.setSaveAll()}}();
Application.prototype=Object.create(AccountBaseWithFields.prototype);Application.prototype.constructor=AccountBaseWithFields;Application.prototype.getDisplayClass=function(){return ApplicationDisplay};Application.prototype.getRecordType=function(){return"Account"};Application.prototype.TYPE="Application";
(function(g,l,k,f){(function(){VaultItemBase.prototype.getRecordType=function(){return null};VaultItemBase.prototype.sortByFunction=function(b,a,c,e){b=b[c].apply(b);a=a[c].apply(a);return b>a?e?1:-1:b<a?e?-1:1:0};VaultItemBase.prototype.sortByTextFunction=function(){var b=function(b,a){b=b[a].apply(b);return"string"===typeof b?b.toLowerCase():""};return function(a,c,e,h){a=b(a,e);c=b(c,e);return a>c?h?1:-1:a<c?h?-1:1:0}}();VaultItemBase.prototype.sortByNameAsc=function(b,a){return VaultItemBase.prototype.sortByTextFunction(b,
a,"getName",!0)};VaultItemBase.prototype.sortByNameDesc=function(b,a){return VaultItemBase.prototype.sortByTextFunction(b,a,"getName",!1)};VaultItemBase.prototype.lockForUpdate=function(){for(var b=0,a=this._views.length;b<a;++b)this._views[b].lockForUpdate()};VaultItemBase.prototype.unlock=function(){for(var b=0,a=this._views.length;b<a;++b)this._views[b].unlock()};VaultItemBase.prototype.updateViews=function(b,a){for(var c=this._views.slice(),e=0,d=c.length;e<d;++e)c[e].updateView(b,a)};VaultItemBase.prototype.destroyViews=
function(){for(var b=this._views.slice(),a=0,c=b.length;a<c;++a)b[a].destruct();this._views=[]};VaultItemBase.prototype.newDisplayObject=function(){return new (this.getDisplayClass())(this)};VaultItemBase.prototype.addView=function(b){this._views.push(b)};VaultItemBase.prototype.removeView=function(b){for(var a=0,c=this._views.length;a<c;++a)if(this._views[a]===b){this._views.splice(a,1);break}};VaultItemBase.prototype.isNew=function(){return"0"===this.getID()};VaultItemBase.prototype.createHandler=
function(b){var a=this;if(1<arguments.length){for(var c=[],e=1,h=arguments.length;e<h;++e)c.push(arguments[e]);return function(){b.apply(a,c)}}return function(){b.apply(a,arguments)}};VaultItemBase.prototype.update=function(b,a,c){f.removeItem(this);b&&(this._data=b);f.addItem(this);this._sharedGroup=a?a.getSharedGroup():null;k.getOption(c,"updateViews",!0)&&(b=null,Array.isArray(this._views)&&(b=(b=this._views[0])&&b._parent?b._parent._model:null),this.updateViews(a,c),bg.get("g_nofolder_feature_enabled")&&
b&&b._data&&b._views&&(a=0===b._views.length,b._data.group!==Strings.Vault.NONE_GROUP&&b._data.group!==Strings.Consts.NONE_GROUP||!a||f.removeItem(b)))};VaultItemBase.prototype.deleteUpdates=function(b){(void 0===b||b)&&this.publishDeleteSuccess(1);b=Array.isArray(this._views)?this._views[0]&&this._views[0]._parent?this._views[0]._parent._model:null:null;this.destroyViews();f.removeItem(this);Topics.get(Topics.ITEM_REMOVED).publish();if(bg.get("g_nofolder_feature_enabled")&&b&&b._data&&b._views){var a=
0===b._views.length;b._data.group!==Strings.Vault.NONE_GROUP&&b._data.group!==Strings.Consts.NONE_GROUP||!a||f.removeItem(b)}};VaultItemBase.prototype.getRepromptType=function(){return null};VaultItemBase.prototype.publishAdd=function(b,a,c){f.addItem(this);this.publishAddSuccess(1);Topics.get(b).publish(this,a,c)};VaultItemBase.prototype.getSuccessfulAddMessage=function(b){return 1<b?Strings.translateString("%1 items were added.",b):Strings.translateString("%1 was added.",this.toString())};VaultItemBase.prototype.getSuccessfulDeleteMessage=
function(b){return 1<b?Strings.translateString("%1 items were deleted.",b):Strings.translateString("%1 was deleted.",this.toString())};VaultItemBase.prototype.getSuccessfulDeleteMessage=function(b){return 1<b?Strings.translateString("%1 items were deleted.",b):Strings.translateString("%1 was deleted.",this.toString())};VaultItemBase.prototype.getSuccessfulRestoreMessage=function(b){return 1<b?Strings.translateString("%1 items were restored.",b):Strings.translateString("%1 was restored.",this.toString())};
VaultItemBase.prototype.getSuccessfulRenameMessage=function(b){return 1<b?Strings.translateString("%1 items were renamed.",b):Strings.translateString("%1 was renamed.",this.toString())};VaultItemBase.prototype.getSuccessfulRemoveMessage=function(b){return 1<b?Strings.translateString("%1 items were removed.",b):Strings.translateString("%1 was removed.",this.toString())};VaultItemBase.prototype.getSuccessfulSaveMessage=function(b){return 1<b?Strings.translateString("%1 items were saved.",b):Strings.translateString("%1 was saved.",
this.toString())};VaultItemBase.prototype.getSuccessfulPurgeMessage=function(b){return 1<b?Strings.translateString("%1 items were purged.",b):Strings.translateString("%1 was purged.",this.toString())};VaultItemBase.prototype.getSuccessfulMoveMessage=function(b,a){return 1<b?Strings.translateString("%1 items were moved to %2.",b,a):Strings.translateString("%1 was moved to %2.",this.toString(),a)};VaultItemBase.prototype.getSuccessfulOrganizeMessage=function(b,a){return 1<b?Strings.translateString("%1 items were organized to %2.",
b,a):Strings.translateString("%1 was organized to %2.",this.toString(),a)};VaultItemBase.prototype.getSuccessfulAddToFavoritesMessage=function(b){return 1<b?Strings.translateString("%1 items were added to Favorites.",b):Strings.translateString("%1 was added to Favorites.",this.toString())};VaultItemBase.prototype.publishAddSuccess=function(b){Topics.get(Topics.SUCCESS).publish(this.getSuccessfulAddMessage(b))};VaultItemBase.prototype.publishDeleteSuccess=function(b){Topics.get(Topics.SUCCESS).publish(this.getSuccessfulDeleteMessage(b))};
VaultItemBase.prototype.publishRenameSuccess=function(b){Topics.get(Topics.SUCCESS).publish(this.getSuccessfulRenameMessage(b))};VaultItemBase.prototype.publishRemoveSuccess=function(b){Topics.get(Topics.SUCCESS).publish(this.getSuccessfulRemoveMessage(b))};VaultItemBase.prototype.publishRestoreSuccess=function(b){Topics.get(Topics.SUCCESS).publish(this.getSuccessfulRestoreMessage(b))};VaultItemBase.prototype.publishSaveSuccess=function(b){Topics.get(Topics.SUCCESS).publish(this.getSuccessfulSaveMessage(b))};
VaultItemBase.prototype.publishPurgeSuccess=function(b){Topics.get(Topics.SUCCESS).publish(this.getSuccessfulPurgeMessage(b))};VaultItemBase.prototype.publishMoveSuccess=function(b,a){Topics.get(Topics.SUCCESS).publish(this.getSuccessfulMoveMessage(b,a))};VaultItemBase.prototype.publishOrganizeSuccess=function(b,a){Topics.get(Topics.SUCCESS).publish(this.getSuccessfulOrganizeMessage(b,a))};VaultItemBase.prototype.publishAddToFavoritesSuccess=function(b){Topics.get(Topics.SUCCESS).publish(this.getSuccessfulAddToFavoritesMessage(b))};
VaultItemBase.prototype.handleClickEvent=function(b,a){switch(b){case Constants.ACTION_EDIT:this.edit(a);break;case Constants.ACTION_DELETE:this.deleteItem(a);break;case Constants.ACTION_PURGE:this.purge(a);break;case Constants.ACTION_RESTORE:this.restore(a);break;case Constants.ACTION_MOVE_TO_FOLDER:this.moveToFolder(a.group,a.itemsForAction,a)}};VaultItemBase.prototype.isShared=function(){var b=this.getSharedGroup();return b&&!(b instanceof LinkedGroup)};VaultItemBase.prototype.shouldPasswordProtectShare=
function(){return!0};VaultItemBase.prototype.passwordProtect=function(b,a){for(var c=k.getOption(a,"itemsForAction",[this]),e=!1,h={},d=0,n=c.length;d<n;++d){var f=c[d];if(f.passwordProtected()){e=!0;break}f.shouldPasswordProtectShare()&&f.isShared()&&(h.switch_f_prompt=!0)}a=a||{};e?delete a.types:a.types=k.getProperties(h).concat(k.getOption(a,"types",[]));this.reprompt(b,a)};VaultItemBase.prototype.reprompt=function(b,a){return f.reprompt(this.createHandler(function(){b.apply(this)}),a)};var a=
function(b,a){for(var c=b.itemsForAction,e,h=0,d=c.length;h<d;++h){var n=c[h];if(void 0===e)e=n.getShareID();else if(e!==n.getShareID()){Topics.get(Topics.ERROR).publish(Strings.translateString("Sorry, you cannot perform this operation on a mix of shared and non-shared folders, or multiple shared folders at once."));return}}a(b,e)};VaultItemBase.prototype.purge=function(){var b=function(b){return 1<b.length?this instanceof Group?Strings.translateString(Strings.VaultDynamic.CONFIRM_PURGE_PLURAL):Strings.translateString(Strings.VaultDynamic.CONFRIM_PURGE_FOLDER):
Strings.translateString(Strings.VaultDynamic.CONFIRM_PURGE,b[0].toString())},d=function(a,e){var c=a.itemsForAction;LPRequest.makeUpdateRequest(f.purgeDeletedItems,{parameters:[c,e],success:function(){for(var b=0,a=c.length;b<a;b++)c[b].deleteUpdates(!1);c[0].publishPurgeSuccess(c.length)},confirm:{title:Strings.Vault.PURGE,text:b.call(this,c)}})};return function(b){a(b,d)}}();VaultItemBase.prototype.restore=function(){var b=function(b){return 1<b.length?this instanceof Group?Strings.translateString(Strings.VaultDynamic.CONFIRM_RESTORE_FOLDER):
Strings.translateString(Strings.VaultDynamic.CONFIRM_RESTORE_PLURAL):Strings.translateString(Strings.VaultDynamic.CONFIRM_RESTORE,b[0].toString())},d=function(a,e){var c=a.itemsForAction;LPRequest.makeRequest(f.restoreDeletedItems,{parameters:[c,e],success:function(){for(var b=0,a=c.length;b<a;b++)c[b].deleteUpdates(!1);c[0].publishRestoreSuccess(c.length);f.refreshSites()},confirm:{title:Strings.Vault.RESTORE,text:b.call(this,c)}})};return function(b){a(b,d)}}();VaultItemBase.prototype.confirmDelete=
function(b){return b&&1<b.length?{title:Strings.Vault.DELETE,text:Strings.translateString(Strings.VaultDynamic.DELETE_CONFIRM_PLURAL)}:{title:Strings.Vault.DELETE,text:Strings.translateString(Strings.VaultDynamic.DELETE_CONFIRM,this.toString())}};VaultItemBase.prototype.isDeleted=function(){return"1"===this._data.deleted};VaultItemBase.prototype.getName=function(){var b=this._data.name;return b?b:""};VaultItemBase.prototype.getURL=function(){return this._data.url};VaultItemBase.prototype.isFavorite=
function(){return"1"===this._data.fav};VaultItemBase.prototype.setFavorite=function(b){this._data.fav=b?"1":"0"};VaultItemBase.prototype.processEnteredData=function(b,a,c){for(var e in b)c=this._data[e],"boolean"!==typeof b[e]||"0"!==c&&"1"!==c||(b[e]=b[e]?"1":"0");a&&a.getSharedGroup()?b.sharefolderid=a.getShareID():delete b.sharefolderid};VaultItemBase.prototype.saveFromDialog=function(b,a,c){var e=a?a.getKey():this.getKey();this.processEnteredData(b,a,e,c);b=g.extend({},this._data,b);this.save(b,
a,c);this.noFolderTrackingEvent(b)};VaultItemBase.prototype.addFromDialog=function(b,a,c){var e=a?a.getKey():this.getKey();this.processEnteredData(b,a,e,c);g.extend(this._data,b);this.add(a,c);this.noFolderTrackingEvent(b)};VaultItemBase.prototype.getFormData=function(b){var a={},c;for(c in b){b="pwprotect"===c||"autologin"===c||"never_autofill"===c||"fav"===c;var e=this._data[c];b&&"1"===e?a[c]=!0:b&&"0"===e?a[c]=!1:void 0!==e&&"object"!==typeof e&&(a[c]=e)}return a};VaultItemBase.prototype.getKey=
function(){var b=this.getSharedGroup();return b?b.getKey():f.getLocalKey()};VaultItemBase.prototype.getShareID=function(){var b=this.getSharedGroup();return b?b.getID():this._data.sharefolderid||""};VaultItemBase.prototype.isReadOnly=function(){var b=this.getSharedGroup();return b?b.isReadOnly():!1};VaultItemBase.prototype.getShareInfo=function(){var b=this.getSharedGroup();return b?b._shareInfo:null};VaultItemBase.prototype.getSharedGroup=function(){return this._sharedGroup?this._sharedGroup:null};
VaultItemBase.prototype.getURLArguments=function(b,a,c){return g.param(this.getPostData(b,a,c))};VaultItemBase.prototype.getGroupName=function(){return this._data.group};VaultItemBase.prototype.getGroupParentName=function(){var b=this._data.group,a=b.lastIndexOf("\\");return 0<a?b.substring(0,a):""};VaultItemBase.prototype.getSearchTokens=function(b){return[this.getName()]};VaultItemBase.prototype.getPostData=function(b,a,c){a={extjs:1,localupdate:1,ajax:1};c&&(c.source&&(a.source=c.source),c.folder&&
(a.folder=c.folder));bg.Policies.logNameEnabled()&&(a.n=bg.AES.url2hex(b.name));bg.Policies.logUserNameEnabled()&&(a.un=bg.AES.url2hex(b.unencryptedUsername));return a};VaultItemBase.prototype.passwordProtected=function(){return this.getRepromptType()&&bg.get("g_prompts")[this.getRepromptType()]};VaultItemBase.prototype.getLastTouch=function(){return 0};VaultItemBase.prototype.edit=function(a){Topics.get(this.getEditTopicID()).publish({vaultItem:this,dialogActions:a.dialogActions})};VaultItemBase.prototype.encryptIfNecessary=
function(a,d,c){var b=this.getKey();return f.decryptMobile(this._data[a],!0,b)!==d||c!==b?f.encryptMobile(d,!0,c):this._data[a]};VaultItemBase.prototype.noFolderTrackingEvent=function(a){var b=a.group;if(b&&"(none)"!==b){for(var c=f.getGroups(),e=!1,h=!1,m=0,n=c.length;m<n;++m)switch(c[m].getName()){case b:e=!0;break;case "(none)":h=!0}b={folder:b,foldercount:h?c.length:c.length+1,nofolderfeatureenabled:bg.get("g_nofolder_feature_enabled")?!0:!1};a.hasOwnProperty("groupParent")&&(b.source="manual");
e||bg.sendLpImprove("no_folder::user_folder_created",b)}}})();(function(){VaultItem.prototype.handleClickEvent=function(a,b){switch(a){case Constants.ACTION_SHARE:this.share(b);break;default:VaultItemBase.prototype.handleClickEvent.apply(this,arguments)}};VaultItem.prototype.share=function(a){this.passwordProtect(function(){Topics.get(Topics.ITEM_SHARE).publish(a.itemsForAction)},a)};VaultItem.prototype.revertPasswordChange=function(a){LPRequest.makeUpdateRequest(f.revertPasswordChange,{params:{key:this.getKey(),
aid:this.getID(),shareId:this.getShareID()},success:function(){a&&"function"===typeof a.success&&a.success()},error:function(){a&&"function"===typeof a.error&&a.error()}})};VaultItem.prototype.deleteItem=function(a){for(var b=a&&a.itemsForAction||[this],d,c=0,e=b.length;c<e;++c){var h=b[c];if(h.isReadOnly()){Topics.get(Topics.ERROR).publish(Strings.translateString(Strings.VaultDynamic.PERMISSION_ERROR_DELETE,h.getSharedGroup().toString()));return}if(void 0===d)d=h.getSharedGroup();else if(d!==h.getSharedGroup()){Topics.get(Topics.ERROR).publish(Strings.translateString("Sorry, you cannot perform this operation on a mix of shared and non-shared folders, or multiple shared folders at once."));
return}}this.passwordProtect(function(){LPRequest.makeLockItemUpdateRequest(f.deleteItem,{parameters:[b],items:b,success:function(){b[0].publishDeleteSuccess(b.length);for(var e=0,c=b.length;e<c;++e)b[e].deleteUpdates(!1);a.success&&a.success()},confirm:k.getOption(a,"confirm",!0)?b[0].confirmDelete(b):null})},a)};(function(){VaultItem.prototype.moveToFolderPostCheck=function(c,e,h,m){if(0<c.length||0<e.length){var n=k.getOption(m,"saveFromDialog",!1),u=function(){var p=c.concat(e);LPRequest.makeLockItemUpdateRequest(f.moveToFolder,
{parameters:[p,h],items:p,success:function(e){a(c,e,h,m);b(e,h,m);if(!n)if(e=h.toString(),bg.get("g_nofolder_feature_enabled")){if(e===Strings.Vault.GROUP+" "+Strings.Vault.NONE_GROUP||e===Strings.Vault.GROUP+" "+Strings.Consts.NONE_GROUP)e=Strings.Vault.NO_FOLDER;p[0].publishOrganizeSuccess(p.length,e)}else p[0].publishMoveSuccess(p.length,e);m&&m.success&&m.success()},confirm:d(c,h)})};n?u():this.passwordProtect(u,{itemsForAction:c.concat(e)})}};Group.prototype.moveToFolderPostCheck=function(c,
e,h,m){var n=g.extend(!0,{},this._data);n.group=h.getName()+"\\"+this.getGroupName();(function(e){LPRequest.makeUpdateRequest(f.renameGroup,{parameters:[e,n],success:function(d){a([e],d,h,m);a(c,d,h,g.extend(m,{updateViews:!1}));b(d,h,m);e.publishMoveSuccess(1,h.toString())},confirm:d(c,h)})})(this)};var a=function(a,b,h,d){for(var e=0,c=a.length;e<c;++e){var m=a[e],f=m.getID();b&&b[f]?(m.update(b[f],h,d),delete b[f]):m.update(m._data,h,d)}},b=function(a,b,h){for(var e in a){var c=a[e];c.sn?(new Note(c,
b.getSharedGroup())).publishAdd(Topics.NOTE_ADDED,b,h):c.appaid?(new Application(c,b.getSharedGroup())).publishAdd(Topics.SITE_ADDED,b,h):(new Account(c,b.getSharedGroup())).publishAdd(Topics.SITE_ADDED,b,h)}},d=function(a,b){var e=null,c=!1,d=!1,f=!1,p=!1;b=b?b.getSharedGroup():null;for(var g=0,k=a.length;g<k;++g){var l=a[g],q=l.getSharedGroup();q?b?q!==b&&(c=!0):q instanceof LinkedGroup||(p=!0):!b||b instanceof LinkedGroup||(l._data.individualshare?f=!0:d=!0)}if(c||d||p||f)a=[],c&&a.push(Strings.translateString("You are moving items to a different shared folder. This may change who has access to them.")),
d&&a.push(Strings.translateString("You are moving sites to a shared folder. Others may now have access to them.")),p&&a.push(Strings.translateString("You are moving items from a shared folder into your vault. Others may lose access to them.")),f?(a.push(Strings.translateString("Any item that is currently shared with another user cannot be moved into a shared folder.")),a.push(Strings.translateString("Would you like to make a copy?"))):a.push(Strings.translateString("Do you want to continue?")),e=
{title:Strings.translateString("Shared Folders"),text:a};return e};AccountBase.prototype.saveFromDialog=function(a,b){var e=d([this],b);if(e){for(var c=[VaultItem.prototype.saveFromDialog],f=0,g=arguments.length;f<g;++f)c.push(arguments[f]);e.handler=this.createHandler.apply(this,c);Topics.get(Topics.CONFIRM).publish(e)}else VaultItem.prototype.saveFromDialog.apply(this,arguments)};VaultItem.prototype.moveToFolder=function(a,b,h){if(a.isReadOnly())Topics.get(Topics.ERROR).publish(Strings.translateString(Strings.VaultDynamic.PERMISSION_ERROR_MOVE,
a.toString()));else{for(var e=[],c=[],d=[],f=[],g=a.getSharedGroup(),l=0,r=b.length;l<r;++l){var q=b[l];q.isReadOnly()?d.push(q):g&&q._data.individualshare?0<parseInt(q._data.sharedfromaid)?c.push(q):e.push(q):f.push(q)}b=[];0<c.length&&b.push({type:"alert",title:Strings.translateString("Error"),text:[Strings.translateString("The following items have been individually shared with you and cannot be moved into a shared folder:"),k.buildDialogItemContainer(c)]});0<d.length&&b.push({type:"alert",title:Strings.translateString("Error"),
text:[Strings.translateString("You do not have permission to move the following items from their respective shared folders:"),k.buildDialogItemContainer(d)]});0<e.length&&b.push({type:"confirmation",title:Strings.translateString("Error"),text:[Strings.translateString("The following items have already been shared individually and cannot be moved to a shared folder:"),Strings.translateString("Would you like to make a copy?"),k.buildDialogItemContainer(e)],closeHandler:function(){e.splice(0,e.length)}});
0<b.length?k.openAlerts(b,function(b){return function(){b.moveToFolderPostCheck.call(b,f,e,a,h)}}(this)):this.moveToFolderPostCheck.call(this,f,e,a,h)}}})();VaultItem.prototype.passwordProtected=function(){return this._data.pwprotect||VaultItemBase.prototype.passwordProtected.apply(this,arguments)};VaultItem.prototype.getPostData=function(a,b){var d=VaultItemBase.prototype.getPostData.apply(this,arguments);a.pwprotect&&(d.pwprotect="on");return d}})();(function(){AccountBase.prototype.getLastTouch=
function(){return parseInt(this._data.last_touch)};AccountBase.prototype.getID=function(){return this._data.aid};AccountBase.prototype.setID=function(a){this._data.aid=a};AccountBase.prototype.getFormData=function(a){var b=VaultItem.prototype.getFormData.apply(this,arguments);b.extra=f.decryptMobile(this._data.extra,!0,this.getKey());return b};AccountBase.prototype.getPostData=function(a,b){var d=VaultItem.prototype.getPostData.apply(this,arguments),c=b?b.getKey():f.getLocalKey();d.aid=this.getID();
d.name=f.encryptWithKey(a.name,c);d.extra=f.encryptWithBTOA(a.extra);var e=b?b.getSharedGroup():null;e?(d.sharedfolderid=e.getID(),d.grouping=f.encryptWithKey(a.group.substring(e.getName().length+1),c)):d.grouping=f.encryptWithKey(a.group,c);a.pwprotect&&(d.pwprotect="on");"1"===a.fav&&(d.fav="on");return d};AccountBase.prototype.checkForSharedGroupChange=function(a){var b=this.getSharedGroup();a=a.getSharedGroup();return(null!==b||null!==a)&&b!==a};AccountBase.prototype.handleClickEvent=function(a,
b){switch(a){case Constants.ACTION_COPY_USERNAME:this.copyUsername();break;case Constants.ACTION_COPY_PASSWORD:this.copyPassword(b);break;case Constants.ACTION_CLONE:this.cloneItem();break;default:VaultItem.prototype.handleClickEvent.apply(this,arguments)}};AccountBase.prototype.getSearchTokens=function(a){var b=VaultItem.prototype.getSearchTokens.apply(this,arguments);a.searchNotes&&this._data.extra&&!this.passwordProtected()&&b.push(f.decryptMobile(this._data.extra,!0,this.getKey()));return b};
AccountBase.prototype.getCloneData=function(){var a=this.getFormData(DialogInput.getProperties(this._data));a.name=a.name+" - "+Strings.translateString("Copy");delete a.aid;return a};AccountBase.prototype.processEnteredData=function(a,b,d){VaultItem.prototype.processEnteredData.apply(this,arguments);a.encgroup=this.encryptIfNecessary("encgroup",a.group,d);a.encname=this.encryptIfNecessary("encname",a.name,d);a.action&&(a.action=bg.AES.bin2hex(a.action))};AccountBase.prototype.isShared=function(){return VaultItem.prototype.isShared.apply(this,
arguments)||this._data.individualshare||this._data.sharedfromaid};AccountBase.prototype.isSharingEnabled=function(){return null===this.getSharedGroup()&&(!this._data.individualshare||!this._data.sharedfromaid||""===this._data.sharedfromaid)};AccountBase.prototype.copyUsername=function(){f.copyUsername(this)};AccountBase.prototype.copyPassword=function(){this.canViewPassword()?this.passwordProtect(function(){f.copyPassword(this)}):Topics.get(Topics.ERROR).publish(Strings.translateString("This is a shared site. You are not permitted to copy the password."))};
AccountBase.prototype.isReceivedShare=function(){return this._data.individualshare&&this._data.sharedfromaid}})();(function(){AccountBaseWithFields.prototype.REPROMPT_TYPE_VIEW_PW="view_pw_prompt";AccountBaseWithFields.prototype.getFormData=function(a){var b=AccountBase.prototype.getFormData.apply(this,arguments);b.fields=[];for(var d=0,c=this._data.fields.length;d<c;++d){var e=this._data.fields[d],h={name:e.name||e.id,type:e.type,value:this.getFieldValue(e,!0),formname:e.formname};"checkbox"===h.type&&
(h.valueAttribute=e.value);b.fields.push(h)}b.save_all=this._data.save_all;return b};AccountBaseWithFields.prototype.processEnteredData=function(a,b,d,c){AccountBase.prototype.processEnteredData.apply(this,arguments);var e=this.getKey(),h=a.unencryptedUsername;a.username=this.encryptIfNecessary("username",a.unencryptedUsername,d);a.password=this.encryptIfNecessary("password",a.password,d);a.extra=this.encryptIfNecessary("extra",a.extra,d);if(a.fields)for(var f=0;f<a.fields.length;++f){var n=a.fields[f],
g=this.getFieldValue(n),p=this._data.fields[f];g!==this.getFieldValue(p,!0)||e!==d||n.formname!==p.formname||n.name!==p.name?(this.processEnteredFieldData(n,b,d),g===h&&"password"!==n.type?n.value=a.username:a.password&&"password"===n.type?n.value=a.password:c.saveFields=!0):a.fields[f]=p}};AccountBaseWithFields.prototype.getFieldValue=function(a,b){var d=null;if(a)switch(d=a.value,a.type){case "checkbox":void 0!==a.checked&&(d=a.checked);break;case "radio":case "select":case "select-one":break;default:b&&
(d=f.decryptMobile(a.value,!0,this.getKey()))}return d};AccountBaseWithFields.prototype.processEnteredFieldData=function(a,b,d){this.defaultFieldValues(a);switch(a.type){case "checkbox":a.checked=a.value;a.value=a.valueAttribute||"";break;case "radio":case "select":case "select-one":break;default:void 0===d&&(d=b?b.getKey():this.getKey()),a.value=f.encryptMobile(a.value,!0,d)}};AccountBaseWithFields.prototype.getFieldPostData=function(a,b){var d=a.value;switch(a.type){case "checkbox":b&&(d+=a.checked?
"-1":"-0");break;case "radio":d+="-1";break;case "select":case "select-one":break;default:d=f.encryptWithBTOA(a.value)}b={name:a.name,type:a.type,value:d,urid:a.urid};a.formname&&(b.formname=a.formname);return b};AccountBaseWithFields.prototype.defaultFieldValues=function(){var a={checked:!1,formname:"",name:"",otherfield:!1,otherlogin:"0",type:"",urid:"0",url:"",value:""};return function(b){this.defaultFields(a,b)}}();AccountBaseWithFields.prototype.removeField=function(a){this._data.fields.splice(a,
1)};AccountBaseWithFields.prototype.addField=function(a,b){void 0===b&&(b=this._data.fields);a=g.extend({},a);this.defaultFieldValues(a);b.push(a);return b.length-1};AccountBaseWithFields.prototype.canViewPassword=function(){var a=this.getSharedGroup();return!a||a.hasPasswordAccess()};AccountBaseWithFields.prototype.cloneItem=function(){this.canViewPassword()?this.passwordProtect(function(){Topics.get(this.getEditTopicID()).publish({defaultData:this.getCloneData()})},{types:this.REPROMPT_TYPE_VIEW_PW}):
Topics.get(Topics.ERROR).publish(Strings.translateString("This is a shared site. You are not permitted to copy the password."))}})();(function(){Account.prototype.REPROMPT_TYPE="edit_site_prompt";Account.prototype.isURLLaunchable=function(){return"undefined"!==typeof this._data.url&&(0===this._data.url.indexOf("http://")||0===this._data.url.indexOf("https://")||0===this._data.url.indexOf("ssh://"))};Account.prototype.isSharingEnabled=function(){return this._data.url&&AccountBase.prototype.isSharingEnabled.apply(this,
arguments)};Account.prototype.isLaunchEnabled=function(){return this.isURLLaunchable()};Account.prototype.canViewPassword=function(){return AccountBaseWithFields.prototype.canViewPassword.apply(this,arguments)&&!this.isReceivedShare()};Account.prototype.getEditTopicID=function(){return Topics.EDIT_SITE};Account.prototype.getPassword=function(){if(this._data.save_all){for(var a=0,b=this._data.fields.length;a<b;++a){var d=this._data.fields[a];if("password"===d.type&&d.value)return f.decryptMobile(d.value,
!0,this.getKey())}return""}return f.decryptMobile(this._data.password,!0,this.getKey())};Account.prototype.getSearchTokens=function(a){var b=AccountBaseWithFields.prototype.getSearchTokens.apply(this,arguments),d=this.getUsername();d&&b.push(d);this._data.url&&b.push(bg.hostof(this._data.url));return b};Account.prototype.getRepromptType=function(){return this.REPROMPT_TYPE};Account.prototype.getUsername=function(){if(this._data.save_all)for(var a=0,b=this._data.fields.length;a<b;++a){var d=this._data.fields[a];
switch(d.type){case "text":case "email":case "tel":if(d.value)return f.decryptMobile(d.value,!0,this.getKey())}}void 0===this._data.unencryptedUsername&&(this._data.unencryptedUsername=f.decryptMobile(this._data.username,!0,this.getKey()));return this._data.unencryptedUsername};Account.prototype.hasGeneratedPassword=function(){return this._data.genpw||0===this.getName().indexOf(Strings.Vault.GENERATED_PREFIX)};Account.prototype.toString=function(){return Strings.Vault.SITE+": "+this._data.name};Account.prototype.handleClickEvent=
function(a,b){switch(a){case Constants.ACTION_COPY_URL:this.copyURL();break;case Constants.ACTION_LAUNCH:this.launch(b);break;case Constants.ACTION_GO_TO_URL:this.goToURL();break;case Constants.ACTION_FILL_SITE:this.fill(b);break;default:AccountBase.prototype.handleClickEvent.apply(this,arguments)}};Account.prototype.launch=function(a){this.passwordProtect(function(){f.launchSite(this,a)},{types:"login_site_prompt"})};Account.prototype.fill=function(a){this.passwordProtect(function(){bg.sendLpImprove("sitelogin",
{copy:0,shareType:this.getShareType(),autologin:this._data&&this._data.autologin?1:0,source:a&&a.source?a.source:null,approach:a&&a.approach?a.approach:null});f.fillSite(this)},{types:"login_site_prompt"})};Account.prototype.copyPassword=function(a){this.canViewPassword()?this.passwordProtect(function(){bg.sendLpImprove("sitelogin",{copy:1,shareType:this.getShareType(),autologin:this._data&&this._data.autologin?1:0,source:a&&a.source?a.source:null,approach:a&&a.approach?a.approach:null});f.copyPassword(this,
a)},{types:this.REPROMPT_TYPE_VIEW_PW}):Topics.get(Topics.ERROR).publish(Strings.translateString("This is a shared site. You are not permitted to copy the password."))};Account.prototype.copyURL=function(){f.copyURL(this)};Account.prototype.goToURL=function(){f.goToURL(this)};Account.prototype.getShareType=function(){var a=this._data;return a&&!0===a.individualshare?"individual":a&&a.sharefolderid?"folder":"none"};Account.prototype.processEnteredData=function(a,b,d){a.save_all&&(delete a.unencryptedUsername,
delete a.password);AccountBaseWithFields.prototype.processEnteredData.apply(this,arguments);a.url&&(a.url=bg.punycode.URLToASCII(a.url.trim()));a.realm_data&&(a.realm_data=f.encryptMobile(a.realm_data,!0,d))};Account.prototype.getFormData=function(a){var b=AccountBaseWithFields.prototype.getFormData.apply(this,arguments);b.url&&(b.url=bg.punycode.URLToUnicode(b.url));a.password&&(b.password=this.getPassword());a.unencryptedUsername&&(b.unencryptedUsername=this.getUsername());return b};Account.prototype.save=
function(a,b,d){(function(c){LPRequest.makeUpdateRequest(f.saveSite,{parameters:[c,a,b,d],success:function(a){var e=c.getPassword();c.update(a,b);c.publishSaveSuccess(1);a=c.getPassword();if(e!==a){a=f.getDomain(c.getURL());for(var m=[],n=f.getSiteModels(),g=0,p=n.length;g<p;++g){var k=n[g];k!==c&&f.getDomain(k.getURL())===a&&k.getPassword()===e&&m.push(k)}0<m.length&&dialogs.changePassword.open({domain:a,items:m,newPassword:c.getPassword()})}d.success&&d.success(c)}})})(this)};Account.prototype.add=
function(a,b){(function(d){LPRequest.makeUpdateRequest(f.addSite,{parameters:[d,a,b],success:function(c){d.update(c,a);d.publishAdd(Topics.SITE_ADDED,a);b.success&&b.success(d)}})})(this)};Account.prototype.getPostData=function(a,b,d){var c=AccountBaseWithFields.prototype.getPostData.apply(this,arguments);c.username=a.username?f.encryptWithBTOA(a.username):"";c.password=a.password?f.encryptWithBTOA(a.password):"";var e=bg.AES.url2hex(a.url);k.getOption(d,"saveFromSubmit",!1)?(c.ref=e,this.isNew()||
(c.replacing=1)):c.url=e;a.never_autofill&&(c.never_autofill="on");a.autologin&&(c.autologin="on");if(a.save_all||k.getOption(d,"saveFromSubmit",!1))c.data=this.getFieldFormData(a.fields);a.save_all&&(c.save_all=1);c.urid=a.urid;"1"===a.basic_auth&&(c.basic_auth="1");a.realm_data&&(c.realm=f.encryptWithBTOA(a.realm_data));return c}})();Account.prototype.getFieldFormData=function(a){for(var b="",d=0,c=a.length;d<c;++d){var e=a[d],h=this.getFieldPostData(e,!0).value;b+=e.formname+"\t"+encodeURIComponent(e.name)+
"\t"+encodeURIComponent(h)+"\t"+encodeURIComponent(e.type)+"\n"}return bg.AES.bin2hex(b)};(function(){Application.prototype.toString=function(){return Strings.Vault.APPLICATION+" "+this.getName()};Application.prototype.getEditTopicID=function(){return Topics.EDIT_APPLICATION};Application.prototype.shouldPasswordProtectShare=function(){return!1};Application.prototype.getCloneData=function(){var a=AccountBaseWithFields.prototype.getCloneData.apply(this,arguments);delete a.appaid;return a};Application.prototype.getID=
function(a){var b=this._data.appaid;a&&(b="app"+b);return b};Application.prototype.setID=function(a){this._data.appaid=a};Application.prototype.isSharingEnabled=function(){return!1};Application.prototype.getLastTouch=AccountBase.prototype.getLastTouch;Application.prototype.handleClickEvent=function(a,b){switch(a){case Constants.ACTION_LAUNCH:f.launchApplication(this);break;default:AccountBaseWithFields.prototype.handleClickEvent.apply(this,arguments)}};Application.prototype.update=function(){AccountBaseWithFields.prototype.update.apply(this,
arguments);this.setSaveAll()};Application.prototype.addField=function(){AccountBaseWithFields.prototype.addField.apply(this,arguments);this.setSaveAll()};Application.prototype.removeField=function(){AccountBaseWithFields.prototype.removeField.apply(this,arguments);this.setSaveAll()};Application.prototype.setSaveAll=function(){for(var a,b,d=0;d<this._data.fields.length;++d){var c=this._data.fields[d];switch(c.type){case "password":a=void 0===a?c:null;break;case "":b=void 0===b?c:null}}b&&a?(this._data.save_all=
!1,this._data.unencryptedUsername=f.decryptMobile(b.value,!0,this.getKey()),this._data.username=b.value,this._data.password=a.value):(this._data.save_all=!0,delete this._data.unencryptedUsername,delete this._data.username,delete this._data.password)};Application.prototype.getUsername=function(){for(var a=0;a<this._data.fields.length;++a){var b=this._data.fields[a];if("password"!==b.type&&b.value)return f.decryptMobile(b.value,!0,this.getKey())}};Application.prototype.getPassword=function(){for(var a=
0;a<this._data.fields.length;++a){var b=this._data.fields[a];if("password"===b.type&&b.value)return f.decryptMobile(b.value,!0,this.getKey())}};Application.prototype.getFormData=function(a){var b=AccountBaseWithFields.prototype.getFormData.apply(this,arguments);this._data.save_all||(b.password=f.decryptMobile(this._data.password,!0,this.getKey()));return b};Application.prototype.getSearchTokens=function(){var a=VaultItem.prototype.getSearchTokens.apply(this,arguments);a.push(this._data.appname);return a};
Application.prototype.add=function(a,b){(function(d){LPRequest.makeUpdateRequest(f.addApplication,{parameters:[d,a,b],success:function(b){d.update(b,a);d.publishAdd(Topics.APPLICATION_ADDED,a)}})})(this)};Application.prototype.save=function(a,b,d){(function(c){LPRequest.makeUpdateRequest(f.saveApplication,{parameters:[c,a,b,d],success:function(){c.update(a,b);c.publishSaveSuccess(1)}})})(this)};Application.prototype.getPostData=function(a,b){var d=AccountBase.prototype.getPostData.apply(this,arguments);
d.appname=a.appname;if(a.fields)for(var c=0;c<a.fields.length;++c){var e=a.fields[c];d["fieldid"+c]=e.name||e.id;d["fieldtype"+c]=e.type;d["fieldvalue"+c]=this.getFieldPostData(e).value}d.appaid=d.aid;delete d.aid;this.isNew()||(d.cmd="updatelpaa");return d}})();(function(){Group.prototype.getDisplayClass=function(){return GroupDisplay};Group.prototype.toString=function(){return Strings.Vault.GROUP+" "+this._data.group};Group.prototype.getName=function(){return this._data.group};Group.prototype.getGroupName=
function(){return this._data.group.substring(this._data.group.lastIndexOf("\\")+1)};Group.prototype.handleClickEvent=function(a,b){switch(a){case Constants.ACTION_RENAME:Topics.get(Topics.RENAME_FOLDER).publish(this);break;case Constants.ACTION_CREATE_SUB_FOLDER:Topics.get(Topics.CREATE_SUB_FOLDER).publish(this);break;case Constants.ACTION_SHARE:Topics.get(Topics.CREATE_SHARED_FOLDER).publish(this,b.itemsForAction);break;default:VaultItemBase.prototype.handleClickEvent.apply(this,arguments)}};Group.prototype.confirmDelete=
function(a){return 0<a?{title:Strings.Vault.DELETE,text:Strings.translateString(Strings.VaultDynamic.DELETE_CONFIRM,Strings.translateString("%1 containing %2 item(s)",this.toString(),a))}:VaultItemBase.prototype.confirmDelete.apply(this)};Group.prototype.deleteItem=function(a){var b=a.itemsForAction.filter(function(a){return!(a instanceof Group)});LPRequest.makeLockItemUpdateRequest(f.deleteFolder,{parameters:[a.itemsForAction],items:a.itemsForAction,success:function(a){return function(){a.deleteUpdates()}}(this),
confirm:this.confirmDelete(b.length)})};Group.prototype.add=function(a){(function(b){LPRequest.makeUpdateRequest(f.addGroup,{parameters:b,success:function(f){b.update(f,a);b.publishAdd(Topics.GROUP_ADDED,a)}})})(this)};Group.prototype.save=function(a,b){(function(d){LPRequest.makeUpdateRequest(f.renameGroup,{parameters:[d,a],success:function(){d.update(a,b);d.publishRenameSuccess(1)}})})(this)};Group.prototype.getFormData=function(a){var b=VaultItemBase.prototype.getFormData.apply(this,arguments);
b.groupName=this.getGroupName();b.groupParent=this.getGroupParentName();return b};Group.prototype.processEnteredData=function(a){VaultItemBase.prototype.processEnteredData.apply(this,arguments);a.groupName&&(a.groupParent?(a.group=a.groupParent+"\\"+a.groupName,delete a.groupParent):a.group=a.groupName,delete a.groupName)}})();(function(){SharedGroup.prototype.setID=function(a){Group.prototype.setID.apply(this,arguments);this._data.sharefolderid=a;this._shareInfo.id=a;this._shareInfo.shareid=a};SharedGroup.prototype.useSharePrefix=
function(){return!0};SharedGroup.prototype.update=function(a){a&&(this._shareInfo.decsharename=a.group);Group.prototype.update.apply(this,arguments)};SharedGroup.prototype.isReadOnly=function(){return"1"===this._shareInfo.readonly};SharedGroup.prototype.canAdminister=function(){return"1"===this._shareInfo.can_administer};SharedGroup.prototype.isPending=function(){return"0"===this._shareInfo.accepted};SharedGroup.prototype.canConvertToLegacy=function(){return f.isEligibleForLegacySharedFolders()&&
this.canAdminister()&&"0"!==this._shareInfo.cid&&bg.get("LPContentScriptFeatures").family_legacy_shared_folders_enabled};SharedGroup.prototype.canConvertToEnterprise=function(){return f.isEnterpriseUser()&&this.canAdminister()&&"1"===this._shareInfo.outside_enterprise&&"0"===this._shareInfo.cid};SharedGroup.prototype.isDownloaded=function(){return"1"===this._shareInfo.download};SharedGroup.prototype.hasPasswordAccess=function(){return"1"===this._shareInfo.give};SharedGroup.prototype.isDeleted=function(){return"1"===
this._shareInfo.deleted};SharedGroup.prototype.isSharingEnabled=function(){return!1};SharedGroup.prototype.getShareName=function(){return this._shareInfo.sharename};SharedGroup.prototype.handleClickEvent=function(a,b){switch(a){case Constants.ACTION_START_DOWNLOADING:this.startDownloading();break;case Constants.ACTION_STOP_DOWNLOADING:this.stopDownloading();break;case Constants.ACTION_MANAGE:this.manage();break;case Constants.ACTION_RESTORE_SHARED_FOLDER:this.restoreSharedFolder();break;case Constants.ACTION_PURGE_SHARED_FOLDER:this.purgeSharedFolder();
break;case Constants.ACTION_ACCEPT:this.accept();break;case Constants.ACTION_REJECT:this.reject();break;case Constants.ACTION_CONVERT:this.convert();break;default:Group.prototype.handleClickEvent.apply(this,arguments)}};SharedGroup.prototype.convert=function(){return function(){dialogs.convertLegacySharedFolder.open({shareId:this._shareInfo.id,groupName:this.getGroupName()})}}();SharedGroup.prototype.manage=function(){var a=function(){this.canConvertToEnterprise()?this.convertToEnterprise():Topics.get(Topics.EDIT_SHARED_FOLDER).publish(this)};
return function(){this.passwordProtect(a)}}();SharedGroup.prototype.accept=function(){var a=function(a){"bad"==a.result&&"verificationrequired"==a.status?dialogs.verifyEmail.open({email:bg.get("g_username")}):(Topics.get(Topics.UPDATE_NOTIFICATION_COUNT).publish(),this.refresh(a.sharedFolder,a.shareInfo),this.update())};return function(){LPRequest.makeRequest(bg.BackgroundServer.sharing.folder.accept,{params:{sharedFolder:this._data,shareInfo:this._shareInfo},lockItems:!0,items:this,success:this.createHandler(a)})}}();
SharedGroup.prototype.reject=function(){var a=function(){Topics.get(Topics.UPDATE_NOTIFICATION_COUNT).publish();this.deleteUpdates(!1)};return function(){LPRequest.makeUpdateRequest(bg.BackgroundServer.sharing.folder.reject,{params:{sharedFolder:this._data,shareInfo:this._shareInfo},lockItems:!0,items:this,success:this.createHandler(a),confirm:{title:Strings.Vault.REJECT,text:[Strings.translateString("Are you sure you want to reject %1?",this.toString())]}})}}();SharedGroup.prototype.stopDownloading=
function(){var a=function(a){this.refresh(a.sharedFolder,a.shareInfo);this.update()};return function(){LPRequest.makeUpdateRequest(f.stopDownloadingFolder,{params:{sharedFolder:this._data,shareInfo:this._shareInfo},lockItems:!0,items:this,success:this.createHandler(a),successMessage:Strings.translateString("%1 will no longer be downloaded.",this.toString()),confirm:{title:Strings.Vault.STOP_DOWNLOADING,text:[Strings.translateString("You are choosing to stop downloading the content of this Shared Folder to your vault. You may always begin downloading the folder content again in the Sharing Center."),
Strings.translateString("Do you want to continue?")]}})}}();SharedGroup.prototype.add=function(){var a=function(a,f,c){var b=[],h={};if(a){var d=a.getName(),n=c.getName();c=function(a){b.push(a.getID());h[a.getID()]=a._data.group.replace(d,n)};if(f)for(var g=0,p=f.length;g<p;++g){var k=f[g];k instanceof DummyGroup||c(k)}a instanceof DummyGroup||c(a)}return{itemsToMove:b,parentMap:h}};return function(b,d,c){var e=a(b,d,this);LPRequest.makeUpdateRequest(f.createSharedFolder,{params:{sharedFolder:this._data,
shareInfo:this._shareInfo},successMessage:0<e.itemsToMove.length?"":void 0,success:this.createHandler(function(a){this.refresh(a.sharedFolder,a.shareInfo);this.update();0<e.itemsToMove.length?LPRequest.makeRequest(f.moveIntoSharedFolder,{params:g.extend(e,{toShareInfo:this._shareInfo}),success:this.createHandler(function(){this.publishAdd(Topics.GROUP_ADDED);d&&d.forEach(function(a){a.update(a._data,this)},this);b&&b.destruct()})}):(this.publishAdd(Topics.GROUP_ADDED),b&&b.destruct());"function"===
typeof c&&c(a)})})}}();SharedGroup.prototype.deleteItem=function(){var a=function(a){this.refresh(a.sharedFolder,a.shareInfo);this.update()};return function(){LPRequest.makeLockItemUpdateRequest(f.deleteSharedFolder,{params:{sharedFolder:this._data,shareInfo:this._shareInfo},items:this,success:this.createHandler(a),successMessage:this.getSuccessfulDeleteMessage(),confirm:this.confirmDelete()})}}();SharedGroup.prototype.getFormData=function(a){var b=Group.prototype.getFormData.apply(this,arguments);
b.groupName=this.getShareGroupName();return b};SharedGroup.prototype.processEnteredData=function(a){a.group=this.SHARED_FOLDER_NAME_PREFIX+a.groupName;delete a.groupName};SharedGroup.prototype.getShareGroupName=function(a){void 0===a&&(a=this._data.group);return a.substring(this.SHARED_FOLDER_NAME_PREFIX.length)};SharedGroup.prototype.saveFromDialog=function(a,b){VaultItem.prototype.saveFromDialog.apply(this,arguments)};SharedGroup.prototype.save=function(){var a=function(a){this.refresh(a.sharedFolder,
a.shareInfo);this.update()};return function(b){LPRequest.makeUpdateRequest(f.renameSharedGroup,{params:{sharedFolder:b,shareInfo:this._shareInfo},success:this.createHandler(a),successMessage:this.getSuccessfulRenameMessage()})}}();SharedGroup.prototype.getKey=function(){return this._shareInfo.key};SharedGroup.prototype.getSharedGroup=function(){return this};SharedGroup.prototype.startDownloading=function(){var a=function(a){this.refresh(a.sharedFolder,a.shareInfo);this.update()};return function(){LPRequest.makeRequest(f.startDownloadingFolder,
{params:{sharedFolder:this._data,shareInfo:this._shareInfo},lockItems:!0,items:this,success:this.createHandler(a),successMessage:Strings.translateString("%1 will now be downloaded.",this.toString())})}}();SharedGroup.prototype.restoreSharedFolder=function(){var a=function(a){this.refresh(a.sharedFolder,a.shareInfo);this.update()};return function(){LPRequest.makeRequest(f.restoreDeletedSharedFolder,{params:{sharedFolder:this._data,shareInfo:this._shareInfo},lockItems:!0,items:this,success:this.createHandler(a),
successMessage:this.getSuccessfulRestoreMessage()})}}();SharedGroup.prototype.purgeSharedFolder=function(){var a=function(){this.publishPurgeSuccess(1);this.deleteUpdates(!1)};return function(){LPRequest.makeLockItemUpdateRequest(f.purgeDeletedSharedFolder,{params:{sharedFolder:this._data,shareInfo:this._shareInfo},items:this,success:this.createHandler(a),confirm:{title:Strings.Vault.PURGE,text:Strings.translateString(Strings.VaultDynamic.CONFIRM_PURGE,this.toString())}})}}();SharedGroup.prototype.convertToEnterprise=
function(){var a=function(a){this.refresh(a.sharedFolder,a.shareInfo);this.update()};return function(){LPRequest.makeLockItemUpdateRequest(bg.BackgroundServer.sharing.folder.convertToEnterprise,{params:{sharedFolder:this._data,shareInfo:this._shareInfo},items:this,success:this.createHandler(a),confirm:{title:Strings.translateString("Convert to Enterprise"),text:[Strings.translateString("This was a shared family folder, but you are now a part of a LastPass Enterprise account.  In order to continue administering this shared folder, you must move it into the enterprise account.  This may mean certain other members of the enterprise account will have access to it."),
Strings.translateString("Do you want to continue?")]}})}}();SharedGroup.prototype.toString=function(){return Strings.Vault.SHARED_FOLDER+": "+this.getName()}})();(function(){LinkedGroup.prototype.useSharePrefix=function(){return!1};LinkedGroup.prototype.handleClickEvent=function(a,b){switch(a){case Constants.ACTION_UNLINK:this.unlink();break;default:SharedGroup.prototype.handleClickEvent.apply(this,arguments)}};LinkedGroup.prototype.unlink=function(){var a=function(){f.removeLinkedAccountInIe();"function"===
typeof bg.removeaccountlinktoken&&bg.removeAccountLinkToken();Topics.get(Topics.SUCCESS).publish(Strings.translateString("Account (%1) unlinked.",this.getName()));this.deleteUpdates(!1);f.refreshSites();Topics.get(Topics.ACCOUNT_UNLINKED).publish();for(var a=f.getFormFillModels(),d=0,c=a.length;d<c;++d){var e=a[d];e.getSharedGroup()===this&&e.deleteUpdates(!1)}};return function(){LPRequest.makeUpdateRequest(f.unlinkAccount,{params:{id:this.getID()},success:this.createHandler(a),confirm:{title:Strings.Vault.UNLINK,
text:Strings.translateString("Are you sure you want to unlink your personal account (%1)",this.getName())}})}}();EmergencyAccessGroup.prototype.unlink=function(){var a=function(){Topics.get(Topics.SUCCESS).publish(Strings.translateString("Account (%1) unlinked.",this.getName()));this.deleteUpdates(!1)};return function(){LPRequest.makeUpdateRequest(f.unlinkEmergencyAccessAccount,{params:{folderID:this.getID(),email:this.getName()},success:this.createHandler(a),confirm:{title:Strings.Vault.UNLINK,text:Strings.translateString("Are you sure you want to unlink your personal account (%1)",
this.getName())}})}}()})();(function(){Note.prototype.NOTE_TYPES={ADDRESS:"Address",BANK:"Bank Account",CREDIT:"Credit Card",DATABASE:"Database",DRIVERS_LICENSE:"Driver's License",EMAIL:"Email Account",GENERIC:"Generic",HEALTH_INSURANCE:"Health Insurance",IM:"Instant Messenger",INSURANCE:"Insurance",MEMBERSHIP:"Membership",PASSPORT:"Passport",SERVER:"Server",SSN:"Social Security",SOFTWARE_LICENSE:"Software License",SSH_KEY:"SSH Key",WIFI:"Wi-Fi Password",CUSTOM:"Custom"};var a=function(){var a={},
b;for(b in Note.prototype.NOTE_TYPES)a[Note.prototype.NOTE_TYPES[b]]=!0;return a}();Note.prototype.REPROMPT_TYPE="edit_sn_prompt";var b=function(a){return a?(a=a.match(/^Custom_(\d+)$/))&&2==a.length:!1},d=function(e){return b(e)||a[e]},c=function(a){return-1!=="zh-CN zh-TW da-DK nl-NL en-US en-GB fi-FI fr-FR fr-CA de-DE hu-HU it-IT ja-JP ko-FR nb-NO pl-PL pt-PT pt-BR ru-RU sk-SK es-ES es-MX sv-SE".split(" ").indexOf(a)};Note.prototype.isValidLanguage=c;Note.prototype.getNoteType=function(){if(void 0===
this._noteType){var a=this._data.notetype?this._data.notetype:this.getKeyValuePairs().NoteType;this._noteType=d(a)?a:this.NOTE_TYPES.GENERIC}return this._noteType};Note.prototype.getLanguage=function(){if(void 0===this._language){var a=this._data.language?this._data.language:this.getKeyValuePairs().Language;c(a)||(a=navigator.language);this._language=c(a)?a:"en-US"}return this._language};Note.prototype.getRecordType=function(){var a=this.getNoteType();return b(a)?"Custom":a};Note.prototype.getTemplate=
function(){return this._data.template};Note.prototype.isCustom=function(){return b(this.getNoteType())};Note.prototype.getAttachmentKey=function(){return this._data.attachkey?bg.AES.hex2bin(f.decrypt(this._data.attachkey,this.getKey())):null};Note.prototype.cloneItem=function(){this.passwordProtect(function(){Topics.get(Topics.EDIT_NOTE).publish({defaultData:this.getCloneData()})})};Note.prototype.getRepromptType=function(){return this.REPROMPT_TYPE};Note.prototype.getEditTopicID=function(){return Topics.EDIT_NOTE};
Note.prototype.handleClickEvent=function(a,b){switch(a){case Constants.ACTION_COPY_NOTE:this.copyNote();break;case Constants.ACTION_COPY_KEY:this.copyPrivateKey();break;case Constants.ACTION_FILL:this.fill(b);break;case Constants.ACTION_COPY_ADDRESS_1:this.copyNoteField("Address 1");break;case Constants.ACTION_COPY_ADDRESS_2:this.copyNoteField("Address 2");break;case Constants.ACTION_COPY_CITY_SLASH_TOWN:this.copyNoteField("City / Town");break;case Constants.ACTION_COPY_ZIP_SLASH_POSTAL_CODE:this.copyNoteField("Zip / Postal Code");
break;case Constants.ACTION_COPY_EMAIL_ADDRESS:this.copyNoteField("Email Address");break;case Constants.ACTION_COPY_PHONE_NUMBER:this.copyPhoneNumber();break;case Constants.ACTION_COPY_BANK_NAME:this.copyNoteField("Bank Name");break;case Constants.ACTION_COPY_ACCOUNT_NUMBER:this.copyNoteField("Account Number");break;case Constants.ACTION_COPY_ROUTING_NUMBER:this.copyNoteField("Routing Number");break;case Constants.ACTION_COPY_NAME_ON_CARD:this.copyNoteField("Name on Card");break;case Constants.ACTION_COPY_SECURITY_CODE:this.copyNoteField("Security Code");
break;case Constants.ACTION_COPY_POLICY_NUMBER:this.copyNoteField("Policy Number");break;case Constants.ACTION_COPY_HEATH_INS_POLICY_NUMBER:this.copyNoteField("Policy Number");break;case Constants.ACTION_COPY_GROUP_ID:this.copyNoteField("Group ID");break;case Constants.ACTION_COPY_MEMBER_ID:this.copyNoteField("Member ID");break;case Constants.ACTION_COPY_INS_POLICY_NUMBER:this.copyNoteField("Policy Number");break;case Constants.ACTION_COPY_MEMBERSHIP_NUMBER:this.copyNoteField("Membership Number");
break;case Constants.ACTION_COPY_PASSPORT_NUMBER:this.copyNoteField("Number");break;case Constants.ACTION_COPY_NUMBER:this.copyNoteField("Number");break;case Constants.ACTION_COPY_LICENSE_KEY:this.copyNoteField("License Key");break;case Constants.ACTION_COPY_ORDER_NUMBER:this.copyNoteField("Number");break;case Constants.ACTION_COPY_SSH_PASSPHRASE:this.copyNoteField("Passphrase");break;case Constants.ACTION_COPY_SSH_PUBLIC_KEY:this.copyNoteField("Public Key");break;case Constants.ACTION_COPY_HOSTNAME:this.copyNoteField("Hostname");
break;case Constants.ACTION_COPY_NOTE_USERNAME:this.copyNoteField("Username");break;case Constants.ACTION_COPY_NOTE_PASSWORD:this.copyNoteField("Password");break;default:AccountBase.prototype.handleClickEvent.apply(this,arguments)}};Note.prototype.fill=function(a){var b="",e="";a&&a.source&&(b=a.source);a&&a.approach&&(e=a.approach);this.passwordProtect(function(){bg.fillitem(this.getID(),!0,void 0,void 0,void 0,b,e)})};Note.prototype.copyNote=function(){var a=function(){f.copyToClipboard(this.getNoteField("Notes"));
bg.loglogin(this.getID())};return function(){this.passwordProtect(a)}}();Note.prototype.copyNoteField=function(a){this.passwordProtect(function(){f.copyToClipboard(this.getNoteField(a));bg.loglogin(this.getID())})};Note.prototype.copyPhoneNumber=function(){var a=function(){f.copyToClipboard(JSON.parse(this.getNoteField("Phone")).num)};return function(){this.passwordProtect(a)}}();Note.prototype.copyPrivateKey=function(){return function(a){var b=this;this.passwordProtect(function(){var e=b.getPrivateKey(a.extra);
if(-1===e.indexOf("-----BEGIN")&&-1===e.indexOf("END-----"))f.copyToClipboard(e);else{var c=e.split(/-----BEGIN.*KEY-----|-----END.*KEY-----/);e=e.split(/-----/);c=c[1];for(var h="",d=0,g=c.length;d<g;++d)h=":"!==c.charAt(d-1)?h+c[d].replace(/\u0020/g,"\n"):h+c[d];f.copyToClipboard("-----"+e[1]+"-----\n"+h+"\n-----"+e[3]+"-----")}bg.loglogin(b.getID())})}}();Note.prototype.getNoteField=function(a,b){b=this.getKeyValuePairs(b);for(var e in b){var c=b[e];if(e===a&&""!==c)return c}return null};Note.prototype.getPassword=
function(){return this.getNoteField("Password")};Note.prototype.hasPassword=function(){return null!==this.getPassword()};Note.prototype.getUsername=function(){return this.getNoteField("Username")};Note.prototype.hasUsername=function(){return null!==this.getUsername()};Note.prototype.getPrivateKey=function(a){return this.getNoteField("Private Key",a)};Note.prototype.hasPrivateKey=function(){return null!==this.getPrivateKey()};Note.prototype.hasNoteField=function(a){return null!==this.getNoteField(a)};
Note.prototype.toString=function(){if(LPFeatures.allowOmarIA()){if(!this._displayName)for(var a=bg.get("RecordTypeConfig"),b=0;b<a.types.length;++b)if(a.types[b].recordType===this.getRecordType()){this._displayName=Strings.translateString(a.types[b].name)+": "+this._data.name;break}return this._displayName}return Strings.Vault.SECURE_NOTE+": "+this._data.name};Note.prototype.getKeyValuePairs=function(){return function(a){var b=f.decryptMobile(this._data.extra,!0,this.getKey()),e=new DialogInput.NestedFields;
if(b&&d(b.substring(9,b.indexOf("\n")))){b=b.split("\n");for(var c,g={},k=0,l=b.length;k<l;++k){var t=b[k],r=t.indexOf(":");if(0<r){var q=t.substring(0,r);if(void 0===g[q]&&("object"!==typeof a||a[q])){e[q]=t.substring(r+1);c=q;g[q]=!0;continue}}c&&(e[c]+="\n"+t)}}else e.Notes=b;return e}}();Note.prototype.getFormData=function(a){var b=VaultItem.prototype.getFormData.apply(this,arguments);b.extra=this.getKeyValuePairs(a.extra);b.notetype=this.getNoteType();b.template=this._data.template;return b};
Note.prototype.processEnteredData=function(a,b,c){AccountBase.prototype.processEnteredData.apply(this,arguments);if(a.notetype!==this.NOTE_TYPES.GENERIC){var e="NoteType:"+a.notetype;LPFeatures.allowOmarIA()&&(e+="\nLanguage:"+(a.language?a.language:"en-US"));var d=a.extra,h;for(h in d)e+="\n"+h+":"+d[h]}else e=a.extra.Notes;a.extra=this.encryptIfNecessary("extra",e,c);this.getKey()!==c&&(a.attachkey=f.encrypt(f.decrypt(this._data.attachkey,this.getKey()),c));if(a.attacharraychanges&&a.attacharraychanges.add&&
0<a.attacharraychanges.add.length){e=this.getAttachmentKey();if(null===e)e=bg.SHA256(bg.lpCreatePass(32,1,1,1,1,1,1,1)),a.attachkey=f.encrypt(e,c),e=bg.AES.hex2bin(e);else if(!e)throw new AttachmentKeyException;d=0;for(h=a.attacharraychanges.add.length;d<h;++d){var g=a.attacharraychanges.add[d],m=this.getID();"0"!==m&&(g.id=m+"-"+g.id,g.parent=m);g.filename=f.encrypt(g.filename,e)}}};Note.prototype.getPostData=function(){return function(a){var b=AccountBase.prototype.getPostData.apply(this,arguments);
b.url=bg.AES.url2hex(this._data.url);b.u=b.url;b.username="";b.password="";b.template=a.template;b.hexName=bg.AES.url2hex(a.name);b.notetype=a.notetype;a.attachkey&&(b.attachkey=a.attachkey);var c=a;if(c.attacharraychanges&&c.attacharraychanges.remove)for(var e=0,d=c.attacharraychanges.remove.length;e<d;++e)b["rmattach"+e]=c.attacharraychanges.remove[e];c=a;if(c.attacharraychanges&&c.attacharraychanges.add)for(e=0,d=c.attacharraychanges.add.length;e<d;++e){var f=c.attacharraychanges.add[e];b["filename"+
e]=f.filename;b["mimetype"+e]=f.mimetype;b["attachid"+e]=f.id.substring(f.id.indexOf("-")+1);b["attachbytes"+e]=f.bytes}return b}}();Note.prototype.update=function(){return function(a,b,c){a&&a.attacharraychanges&&(c=JSON.parse(JSON.stringify(a.attacharraychanges)));AccountBase.prototype.update.apply(this,arguments);var e=c;if(e&&e.remove)for(var d=0,f=e.remove.length;d<f;++d)this.removeAttachment(e.remove[d]);if((e=c)&&e.add)for(d=0,f=e.add.length;d<f;++d)this.addAttachment(new Attachment(e.add[d]));
a.attachpresent=0<this._attachments.length?"1":"";a.attacharraychanges={add:[],remove:[]}}}();Note.prototype.add=function(a,b){(function(c,e){LPRequest.makeUpdateRequest(f.addNote,{parameters:[c,a,b],success:function(b){var d=void 0!=e?JSON.parse(JSON.stringify(e)):e;c.update(b,a,d);c.publishAdd(Topics.NOTE_ADDED,a)}})})(this,this._data.attacharraychanges)};Note.prototype.save=function(a,b,c){var e=this;LPRequest.makeUpdateRequest(f.saveNote,{parameters:[e,a,b,c],success:function(c){e.update(c,b,
a.attacharraychanges);e.publishSaveSuccess(1)}})};Note.prototype.hasAttachments=function(){return 0<this._attachments.length};Note.prototype.getAttachments=function(){return this._attachments};Note.prototype.addAttachment=function(a){a.setParentNote(this);this._attachments.push(a)};Note.prototype.removeAttachment=function(a){for(var b=0,c=this._attachments.length;b<c;++b)if(this._attachments[b]===a||this._attachments[b].getID()===a){this._attachments.splice(b,1);break}}})();(function(){Attachment.prototype.setParentNote=
function(a){if(this._parentNote=a)this._data.parent=a.getID()};Attachment.prototype.getID=function(){return this._data.id};Attachment.prototype.getName=function(){if(null===this._filename)if(null!==this._data.filename&&this._data.filename.length){var a=this._parentNote?this._parentNote.getAttachmentKey():null;a&&(this._filename=f.decrypt(this._data.filename,a))}else{a=this._data.mimetype;var d="";0===a.indexOf("other:")?d="."+a.substring(6):0===a.indexOf("data:audio")?d="."+a.substring(11):0===a.indexOf("data:image")&&
(d="."+a.substring(11));this._filename="attachment"+d}return this._filename?this._filename:this._data.filename};Attachment.prototype.getType=function(){return this._data.mimetype};Attachment.prototype.getBytes=function(){return this._data.bytes};Attachment.prototype.handleClickEvent=function(a,d){switch(a){case Constants.ACTION_OPEN:this.open();break;case Constants.ACTION_SAVE:this.save();break;default:VaultItemBase.prototype.handleClickEvent.apply(this,arguments)}};var a=function(a){return function(){this._parentNote?
a.apply(this,arguments):dialogs.alert.open({title:Strings.translateString("Error"),text:Strings.translateString("Attachment must be saved before it can be viewed.")})}};Attachment.prototype.open=a(function(){f.openAttachment(this)});Attachment.prototype.save=a(function(){f.saveAttachment(this)});Attachment.prototype.deleteItem=function(){Topics.get(Topics.ATTACHMENT_REMOVED).publish(this);this.destroyViews()}})();(function(){FormFill.prototype.REPROMPT_TYPE="view_ff_prompt";FormFill.prototype.FORM_FILL_TYPE_GENERIC=
"0";FormFill.prototype.FORM_FILL_TYPE_CREDIT_CARD="1";FormFill.prototype.getRepromptType=function(){return this.REPROMPT_TYPE};FormFill.prototype.getEditTopicID=function(){return Topics.EDIT_FORM_FILL};FormFill.prototype.getName=function(){return this._data.decprofilename};FormFill.prototype.getID=function(){return this._data.ffid};FormFill.prototype.setID=function(a){this._data.ffid=a};FormFill.prototype.isCreditCard=function(){return this._data.profiletype===this.FORM_FILL_TYPE_CREDIT_CARD};FormFill.prototype.toString=
function(){return Strings.Vault.FORM_FILL+": "+this._data.decprofilename};FormFill.prototype.handleClickEvent=function(a,b){switch(a){case Constants.ACTION_FILL:this.fill(b);break;default:VaultItem.prototype.handleClickEvent.apply(this,arguments)}};FormFill.prototype.fill=function(a){f.fillProfile(this,a?a.source:"vault")};FormFill.prototype.deleteItem=function(a){this.passwordProtect(function(b){return function(){LPRequest.makeLockItemUpdateRequest(f.deleteFormFill,{parameters:[b,a],items:b,success:function(){b.deleteUpdates()},
confirm:b.confirmDelete()})}}(this))};FormFill.prototype.enableCreditMonitoring=function(){LPRequest.makeUpdateRequest(f.createCreditMonitoringProfile,{parameters:this})};FormFill.prototype.add=function(b,e){(function(b){LPRequest.makeUpdateRequest(f.addFormFill,{parameters:[b,e],success:function(a){b.update(a);b._data.creditmon&&b.enableCreditMonitoring();b.publishAdd(Topics.FORM_FILL_ADDED)},confirm:b._data.creditmon?a(b._data,b.getKey()):null})})(this)};var a=function(){var a=function(a,b,c){var e=
k.createElement("tr","settingsRow");e.appendChild(k.createElement("td","settingLabel",b));"string"===typeof c?e.appendChild(k.createElement("td",null,c)):(b=k.createElement("td"),b.appendChild(c),e.appendChild(b));a.appendChild(e)};return function(b,c){var e=[Strings.translateString("Only the below information will be sent to LastPass."),Strings.translateString("Other confidential Form Fill information, such as credit card numbers, will not be sent.")],d=k.createElement("table","settings creditMonConfirm");
a(d,Strings.translateString("Name"),f.decryptMobile(b.firstname,!0,c)+" "+f.decryptMobile(b.lastname,!0,c));a(d,Strings.translateString("Birthday"),f.decryptMobile(b.birthday,!0,c));a(d,Strings.translateString("Social Security Number"),"\u2022\u2022\u2022\u2022 "+f.decryptMobile(b.ssn,!0,c).slice(-4));var g=Strings.translateString("Phone Number");var h=f.decryptMobile(b.phone,!0,c);11===h.length&&(h=h.substring(1));h="("+h.substring(0,3)+") "+h.substring(3,6)+"-"+h.substring(6);a(d,g,h);g=Strings.translateString("Address");
h=k.createElement("div");b.address1&&h.appendChild(k.createElement("p",null,f.decryptMobile(b.address1,!0,c)));b.address2&&h.appendChild(k.createElement("p",null,f.decryptMobile(b.address2,!0,c)));b.address3&&h.appendChild(k.createElement("p",null,f.decryptMobile(b.address3,!0,c)));h.appendChild(k.createElement("p",null,f.decryptMobile(b.city,!0,c)+", "+f.decryptMobile(b.state,!0,c)+" "+f.decryptMobile(b.zip,!0,c)));a(d,g,h);k.addZebraStriping(d);e.push(d);b=k.createElement("p",{compoundtranslation:!0,
"class":"dialogText"},"I have read and agree with the ");b.appendChild(k.createElement("a",{target:"_blank",href:f.getBaseURL()+"creditmonitoring.php?cmd=showterms"},"LastPass Terms and Conditions"));Strings.translate(b);e.push(b);return{title:Strings.Vault.ADD_CREDIT_MON,text:e,nextButtonText:Strings.translateString("I Agree"),backButtonText:Strings.translateString("I Do Not Agree")}}}();FormFill.prototype.save=function(b,e,d){(function(c){LPRequest.makeUpdateRequest(f.saveFormFill,{parameters:[c,
b,d],success:function(){c.update(b);c.publishSaveSuccess(1)},confirm:b.creditmon&&!c._data.creditmon?a(b,c.getKey()):null})})(this)};FormFill.prototype.update=function(a){var b=!1;a.creditmon&&!this._data.creditmon&&(b=!0);VaultItem.prototype.update.apply(this,arguments);b&&this.enableCreditMonitoring()};FormFill.prototype.getPostData=function(a){var b=VaultItem.prototype.getPostData.apply(this,arguments),c=this.getKey(),d;for(d in a){var g=a[d];if(this.isEncryptedField(d))b[d]=f.encryptWithKey(f.decryptMobile(g,
!0,c),c);else switch(d){case "creditmon":case "pwprotect":break;default:b[d]=g}}b.ffid=this.getID();"undefined"!==typeof b.custom_fields&&delete b.custom_fields;a.creditmon&&(b.creditmon="on");return b};FormFill.prototype.isEncryptedField=function(a){if(-1!==a.indexOf("cfid"))return!1;switch(a){case "decprofilename":case "pwprotect":case "creditmon":case "custom_fields":case "profiletype":return!1;default:return!0}};var b=function(a,b){try{var c=JSON.parse(a[b]);delete a[b];a[b+"ext"]=c.ext;a["phone"===
b||"fax"===b?b:b+"phone"]=c.num;a["phone"===b||"fax"===b?b+"3lcc":b+"phone3lcc"]=c.cc3l}catch(m){}},d=function(a,b,d){var c={};c.ext=f.decryptMobile(a[b+"ext"],!0,d);c.num=f.decryptMobile(a["phone"===b||"fax"===b?b:b+"phone"],!0,d);c.cc3l=f.decryptMobile(a["phone"===b||"fax"===b?b+"3lcc":b+"phone3lcc"],!0,d);return JSON.stringify(c)};FormFill.prototype.processEnteredData=function(a,e,d){b(a,"phone");b(a,"mobile");b(a,"eve");b(a,"fax");for(var c in a)if(e=a[c],"custom_fields"===c)for(var g=0,h=e.length;g<
h;++g){var k=e[g],l="customfield"+(g+1);a[l+"cfid"]=k.cfid;a[l+"text"]=f.encryptMobile(k.text,!0,d);a[l+"value"]=f.encryptMobile(k.value,!0,d);a[l+"alttext"]=""}else this.isEncryptedField(c)&&(a[c]=this.encryptIfNecessary(c,a[c],d));delete a.custom_fields;a.profilename=f.encryptMobile(a.decprofilename,!0,d)};FormFill.prototype.getFormData=function(a){var b={},c=this.getKey(),g;for(g in a)this.isEncryptedField(g)?b[g]=f.decryptMobile(this._data[g],!0,c):b[g]=this._data[g];if(a.custom_fields)for(b.custom_fields=
[],a=0,g=this._data.custom_fields.length;a<g;++a){var k=this._data.custom_fields[a],l={};l.cfid=k.cfid;l.text=f.decryptMobile(k.text,!0,c);l.value=f.decryptMobile(k.value,!0,c);k=f.decryptMobile(k.alttext,!0,c);""!==k&&(l.value+="\n"+k);b.custom_fields.push(l)}b.phone=d(this._data,"phone",c);b.mobile=d(this._data,"mobile",c);b.eve=d(this._data,"eve",c);b.fax=d(this._data,"fax",c);return b}})();(function(){Identity.prototype.REPROMPT_TYPE="switch_identity_prompt";Identity.prototype.getRepromptType=
function(){return this.REPROMPT_TYPE};Identity.prototype.getName=function(){return this._data.deciname};Identity.prototype.getID=function(){return this._data.iid};Identity.prototype.setID=function(a){this._data.iid=a};Identity.prototype.handleClickEvent=function(a,b){switch(a){case Constants.ACTION_ENABLE:this.enable();break;default:VaultItemBase.prototype.handleClickEvent.apply(this,arguments)}};Identity.prototype.getEditTopicID=function(a){return Topics.EDIT_IDENTITY};Identity.prototype.enable=
function(){var a=function(){Topics.get(Topics.IDENTITY_ENABLE).publish(this);this._enabled=!0;this.updateViews()};return function(b){k.getOption(b,"reprompt",!0)?this.passwordProtect(function(){a.apply(this);b&&b.callback&&b.callback()}):a.apply(this)}}();Identity.prototype.disable=function(){this._enabled=!1;this.updateViews()};Identity.prototype.processEnteredData=function(a,b,d){a.iname=f.encryptAES(a.deciname,d)};Identity.prototype.save=function(){var a=function(a){this.update(a);this.publishSaveSuccess(1)};
return function(b){LPRequest.makeUpdateRequest(f.saveIdentity,{params:{identity:b},success:this.createHandler(a)})}}();Identity.prototype.add=function(){var a=function(a){this.update(a);this.publishAdd(Topics.IDENTITY_ADDED)};return function(){LPRequest.makeUpdateRequest(f.addIdentity,{params:{identity:this._data},success:this.createHandler(a)})}}();Identity.prototype.deleteItem=function(){var a=function(){this.deleteUpdates()},b=function(){f.logEvent("v_did");LPRequest.makeLockItemUpdateRequest(f.deleteIdentity,
{params:{id:this.getID()},items:this,success:this.createHandler(a),confirm:this.confirmDelete()})};return function(){this._enabled?Topics.get(Topics.ERROR).publish(Strings.translateString("%1 cannot be deleted while enabled.",this.toString())):this.passwordProtect(b)}}();Identity.prototype.toString=function(){return Strings.Vault.IDENTITY+": "+this.getName()}})()})($,document,LPTools,LPProxy);
//# sourceMappingURL=newvault_model_js.js.map